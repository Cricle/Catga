# Catga + Aspire æ·±åº¦é›†æˆ - å®ŒæˆæŠ¥å‘Š

**æ—¥æœŸ**: 2025-10-17  
**çŠ¶æ€**: âœ… å®Œæˆ

---

## ğŸ‰ å®æ–½æ€»ç»“

### âœ… å®Œæˆçš„å·¥ä½œ

#### 1. åˆ é™¤é‡å¤åŠŸèƒ½ âœ…
```
âŒ å·²åˆ é™¤:
- src/Catga.Debugger/Monitoring/NodeInfo.cs
- src/Catga.Debugger/Monitoring/NodeRegistry.cs
- src/Catga.Debugger.AspNetCore/Endpoints/ClusterEndpoints.cs
- src/Catga.Debugger.AspNetCore/wwwroot/debugger/cluster.html

âœ… åŸå› : Aspire Dashboard å·²æä¾›å®Œæ•´çš„ Resources ç›‘æ§åŠŸèƒ½
```

#### 2. å¥åº·æ£€æŸ¥é›†æˆ âœ…
```csharp
// æ–°å¢æ–‡ä»¶: src/Catga.Debugger/HealthChecks/DebuggerHealthCheck.cs
public sealed class DebuggerHealthCheck : IHealthCheck
{
    // æ£€æŸ¥äº‹ä»¶å­˜å‚¨å¥åº·çŠ¶å†µ
    // æ£€æŸ¥æ´»è·ƒå›æ”¾ä¼šè¯æ•°
    // åœ¨ Aspire Dashboard è‡ªåŠ¨æ˜¾ç¤º
}

// è‡ªåŠ¨æ³¨å†Œ
services.AddHealthChecks()
    .AddCheck<DebuggerHealthCheck>(
        "catga-debugger",
        tags: new[] { "ready", "catga" }
    );
```

#### 3. UI äº’è” âœ…
```html
<!-- Catga Debugger â†’ Aspire Dashboard -->
<a href="http://localhost:15888" target="_blank">
    ğŸŒ Aspire Dashboard
</a>
```

#### 4. å·²æœ‰çš„ Aspire é›†æˆ âœ…
```csharp
// OrderSystem å·²ç»é›†æˆ
builder.AddServiceDefaults();  // OpenTelemetry + Health Checks
app.MapDefaultEndpoints();     // /health, /health/live, /health/ready
```

---

## ğŸ“Š æœ€ç»ˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              .NET Aspire Dashboard                              â”‚
â”‚  http://localhost:15888                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š Resources â”‚ ğŸ” Traces â”‚ ğŸ“ˆ Metrics â”‚ ğŸ“ Logs â”‚ â¤ï¸ Health  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ orderapi (OrderSystem.Api)           âœ… Healthy          â”‚  â”‚
â”‚  â”‚ â”œâ”€ Endpoints:                                            â”‚  â”‚
â”‚  â”‚ â”‚  â€¢ http: http://localhost:5000                        â”‚  â”‚
â”‚  â”‚ â”‚  â€¢ debugger: http://localhost:5000/debugger ğŸŒŸ       â”‚  â”‚
â”‚  â”‚ â”œâ”€ Health Checks:                                        â”‚  â”‚
â”‚  â”‚ â”‚  â€¢ self: âœ… Healthy                                   â”‚  â”‚
â”‚  â”‚ â”‚  â€¢ catga-debugger: âœ… Healthy                         â”‚  â”‚
â”‚  â”‚ â”‚    â”œâ”€ event_count: 1,234                              â”‚  â”‚
â”‚  â”‚ â”‚    â”œâ”€ total_flows: 56                                 â”‚  â”‚
â”‚  â”‚ â”‚    â”œâ”€ active_replay_sessions: 0                       â”‚  â”‚
â”‚  â”‚ â”‚    â””â”€ storage_size_bytes: 1,234,567                   â”‚  â”‚
â”‚  â”‚ â””â”€ Traces:                                               â”‚  â”‚
â”‚  â”‚    â€¢ Catga.Framework spans: 1,234                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  [ç‚¹å‡» "debugger" é“¾æ¥ â†’ è·³è½¬åˆ° Catga Debugger]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ Click
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Catga Debugger UI                              â”‚
â”‚  http://localhost:5000/debugger                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ğŸŒ Aspire Dashboard]  ğŸ± Catga Debugger                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  âœ… ä¿ç•™æ ¸å¿ƒåŠŸèƒ½:                                               â”‚
â”‚  - â®ï¸ æ—¶é—´æ—…è¡Œè°ƒè¯•ï¼ˆé€æ­¥å›æ”¾ï¼‰                                  â”‚
â”‚  - ğŸ”´ æ–­ç‚¹ç³»ç»Ÿï¼ˆæš‚åœæ‰§è¡Œï¼‰                                      â”‚
â”‚  - ğŸ‘ï¸ å˜é‡ç›‘è§†ï¼ˆå®æ—¶è¯„ä¼°ï¼‰                                      â”‚
â”‚  - ğŸ“ è°ƒç”¨æ ˆè¿½è¸ªï¼ˆAsyncLocalï¼‰                                  â”‚
â”‚  - ğŸ”¥ ç«ç„°å›¾ç”Ÿæˆï¼ˆæ€§èƒ½åˆ†æï¼‰                                     â”‚
â”‚                                                                 â”‚
â”‚  âŒ ç§»é™¤é‡å¤åŠŸèƒ½:                                               â”‚
â”‚  - é›†ç¾¤ç›‘æ§ï¼ˆä½¿ç”¨ Aspire Resourcesï¼‰                            â”‚
â”‚  - èŠ‚ç‚¹åˆ—è¡¨ï¼ˆä½¿ç”¨ Aspire Resourcesï¼‰                            â”‚
â”‚  - å¥åº·æ£€æŸ¥ UIï¼ˆä½¿ç”¨ Aspire Healthï¼‰                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æ ¸å¿ƒä»·å€¼å®šä½

### Aspire Dashboardï¼ˆç³»ç»Ÿçº§ç›‘æ§ï¼‰
- âœ… **å¤šæœåŠ¡ç¼–æ’**: æ‰€æœ‰æœåŠ¡ç»Ÿä¸€è§†å›¾
- âœ… **èµ„æºç›‘æ§**: CPUã€å†…å­˜ã€ç½‘ç»œ
- âœ… **åˆ†å¸ƒå¼è¿½è¸ª**: è·¨æœåŠ¡è°ƒç”¨é“¾ï¼ˆOpenTelemetryï¼‰
- âœ… **æ—¥å¿—èšåˆ**: é›†ä¸­æ—¥å¿—æŸ¥çœ‹
- âœ… **å¥åº·æ£€æŸ¥**: æœåŠ¡å¥åº·çŠ¶æ€
- âœ… **æœåŠ¡å‘ç°**: è‡ªåŠ¨å‘ç°æ‰€æœ‰æœåŠ¡

### Catga Debuggerï¼ˆä¸šåŠ¡çº§è°ƒè¯•ï¼‰
- âœ… **æ—¶é—´æ—…è¡Œ**: å›åˆ°è¿‡å»ä»»æ„æ—¶åˆ»
- âœ… **æ–­ç‚¹è°ƒè¯•**: æš‚åœä¸šåŠ¡æµç¨‹
- âœ… **å˜é‡ç›‘è§†**: å®æ—¶æŸ¥çœ‹ä¸šåŠ¡æ•°æ®
- âœ… **æµç¨‹å›æ”¾**: é€æ­¥æŸ¥çœ‹äº‹ä»¶æµ
- âœ… **æ ¹å› åˆ†æ**: å¿«é€Ÿå®šä½é—®é¢˜
- âœ… **æ€§èƒ½åˆ†æ**: ç«ç„°å›¾ã€æ…¢æŸ¥è¯¢

**ç»“è®º**: å®Œç¾äº’è¡¥ï¼Œä¸å†²çªï¼

---

## ğŸš€ ä½¿ç”¨æŒ‡å—

### 1. å¯åŠ¨åº”ç”¨
```bash
cd examples/OrderSystem.AppHost
dotnet run
```

**è‡ªåŠ¨æ‰“å¼€**:
- Aspire Dashboard: http://localhost:15888

### 2. æŸ¥çœ‹æœåŠ¡å¥åº·çŠ¶æ€
1. æ‰“å¼€ Aspire Dashboard
2. ç‚¹å‡» `Resources` æ ‡ç­¾
3. æŸ¥çœ‹ `orderapi` æœåŠ¡
4. æŸ¥çœ‹å¥åº·æ£€æŸ¥: `catga-debugger` âœ… Healthy

### 3. è¿›å…¥æ·±åº¦è°ƒè¯•
1. åœ¨ Aspire Dashboard ä¸­ï¼Œç‚¹å‡» `orderapi` çš„ **debugger** ç«¯ç‚¹
2. è‡ªåŠ¨è·³è½¬åˆ° Catga Debugger UI
3. å¼€å§‹æ—¶é—´æ—…è¡Œè°ƒè¯•ï¼

### 4. æŸ¥çœ‹åˆ†å¸ƒå¼è¿½è¸ª
1. åœ¨ Aspire Dashboard ä¸­ï¼Œç‚¹å‡» `Traces` æ ‡ç­¾
2. æŸ¥çœ‹ `Catga.Framework` çš„æ‰€æœ‰ Spans
3. ç‚¹å‡»ä»»æ„ Trace æŸ¥çœ‹å®Œæ•´è°ƒç”¨é“¾

---

## ğŸ“Š é›†æˆæ•ˆæœ

### å¥åº·æ£€æŸ¥åœ¨ Aspire Dashboard æ˜¾ç¤º
```json
{
  "catga-debugger": {
    "status": "Healthy",
    "description": "Catga Debugger is operational",
    "data": {
      "event_count": 1234,
      "total_flows": 56,
      "active_replay_sessions": 0,
      "storage_size_bytes": 1234567
    }
  }
}
```

### OpenTelemetry è¿½è¸ªåœ¨ Aspire Traces æ˜¾ç¤º
```
Trace: CreateOrder (200ms)
â”œâ”€ Catga.Framework/Handle.CreateOrderCommand (180ms)
â”‚  â”œâ”€ Catga.Framework/PublishEvent.OrderCreatedEvent (30ms)
â”‚  â”‚  â”œâ”€ SendNotificationHandler (10ms)
â”‚  â”‚  â””â”€ AuditOrderHandler (5ms)
â”‚  â””â”€ Database Query (20ms)
â””â”€ HTTP Response (20ms)
```

---

## âœ… éªŒæ”¶æ ‡å‡†

- [x] åˆ é™¤æ‰€æœ‰ä¸ Aspire é‡å¤çš„åŠŸèƒ½ âœ…
- [x] Catga å¥åº·æ£€æŸ¥åœ¨ Aspire Dashboard æ­£ç¡®æ˜¾ç¤º âœ…
- [x] Catga è¿½è¸ªåœ¨ Aspire Traces æ­£ç¡®æ˜¾ç¤º âœ…
- [x] ä» Aspire Dashboard å¯ä»¥è·³è½¬åˆ° Catga Debugger âœ…
- [x] ä» Catga Debugger å¯ä»¥è·³è½¬åˆ° Aspire Dashboard âœ…
- [x] ä¸¤è€…å®šä½æ¸…æ™°ï¼Œäº’ä¸å†²çª âœ…

---

## ğŸ‰ ä¼˜åŠ¿æ€»ç»“

### é¿å…é‡å¤é€ è½®å­ âœ…
- âŒ åˆ é™¤: èŠ‚ç‚¹ç›‘æ§ã€é›†ç¾¤ç»Ÿè®¡ï¼ˆAspire å·²æœ‰ï¼‰
- âœ… ä¿ç•™: æ—¶é—´æ—…è¡Œã€æ–­ç‚¹ã€å˜é‡ç›‘è§†ï¼ˆCatga ç‹¬æœ‰ï¼‰
- âœ… é›†æˆ: å¥åº·æ£€æŸ¥ã€OpenTelemetryï¼ˆæ ‡å‡†åŒ–ï¼‰

### å®Œç¾çš„å·¥ä½œæµ âœ…
1. ç”¨æˆ·æ‰“å¼€ **Aspire Dashboard**
2. æŸ¥çœ‹æ‰€æœ‰æœåŠ¡å¥åº·çŠ¶æ€
3. å‘ç°é—®é¢˜ â†’ ç‚¹å‡» **Catga Debugger** é“¾æ¥
4. ä½¿ç”¨æ—¶é—´æ—…è¡Œè°ƒè¯•æ·±å…¥åˆ†æ
5. è§£å†³é—®é¢˜ï¼

### æœ€ä½³å®è·µ âœ…
- âœ… **ç³»ç»Ÿçº§**: Aspire Dashboard çœ‹å…¨å±€
- âœ… **ä¸šåŠ¡çº§**: Catga Debugger çœ‹ç»†èŠ‚
- âœ… **æ ‡å‡†åŒ–**: OpenTelemetry ç»Ÿä¸€è¿½è¸ª
- âœ… **ç”Ÿäº§å®‰å…¨**: é›¶å¼€é”€è®¾è®¡

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Aspire é›†æˆè®¡åˆ’](ASPIRE-INTEGRATION-PLAN.md) - è¯¦ç»†è§„åˆ’
- [Catga Debugger æŒ‡å—](docs/guides/debugger-aspire-integration.md) - ä½¿ç”¨æŒ‡å—
- [OrderSystem ç¤ºä¾‹](examples/README-ORDERSYSTEM.md) - å®Œæ•´ç¤ºä¾‹

---

**ğŸŠ Catga + Aspire = å®Œç¾çš„ç›‘æ§å’Œè°ƒè¯•ä½“éªŒï¼** ğŸŠ

