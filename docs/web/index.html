<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Catga - 高性能 .NET CQRS/Event Sourcing 框架，支持 Native AOT">
    <meta name="keywords" content="Catga, CQRS, Event Sourcing, .NET, C#, Mediator, Native AOT, High Performance">
    <meta name="author" content="Catga Team">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <title>Catga - 现代化 .NET CQRS 框架</title>
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #512BD4;
            --secondary-color: #6C63FF;
            --accent-color: #00D9FF;
            --text-color: #2D3748;
            --text-light: #718096;
            --bg-light: #F7FAFC;
            --bg-white: #FFFFFF;
            --border-color: #E2E8F0;
            --success-color: #48BB78;
            --warning-color: #F59E0B;
            --info-color: #3B82F6;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* Dark Mode */
        [data-theme="dark"] {
            --primary-color: #8B7BF7;
            --secondary-color: #9F8FFF;
            --accent-color: #00F5FF;
            --text-color: #E2E8F0;
            --text-light: #94A3B8;
            --bg-light: #1E293B;
            --bg-white: #0F172A;
            --border-color: #334155;
            --success-color: #10B981;
            --warning-color: #F59E0B;
            --info-color: #3B82F6;
            --gradient: linear-gradient(135deg, #4338CA 0%, #7C3AED 100%);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: var(--bg-light);
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Header */
        header {
            background: var(--bg-white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }

        /* Navigation Actions */
        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle-btn {
            background: var(--bg-light);
            border: 2px solid var(--border-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .theme-toggle-btn:hover {
            background: var(--primary-color);
            transform: scale(1.1) rotate(15deg);
        }

        .theme-icon {
            display: none;
        }

        .light-icon {
            display: inline;
        }

        [data-theme="dark"] .light-icon {
            display: none;
        }

        [data-theme="dark"] .dark-icon {
            display: inline;
        }

        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 15px rgba(81, 43, 212, 0.3);
            transition: all 0.3s;
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
        }

        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .back-to-top:hover {
            background: var(--secondary-color);
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(81, 43, 212, 0.4);
        }

        .back-to-top-icon {
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }

        .loading-screen.hidden {
            opacity: 0;
        }

        .loading-content {
            text-align: center;
            color: white;
        }

        .loading-logo {
            font-size: 5rem;
            margin-bottom: 1rem;
            animation: logoFloat 2s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .loading-text {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 2rem;
            letter-spacing: 0.1em;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            margin: 0 auto;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Hero Section - Enhanced */
        .hero {
            background: var(--gradient);
            color: white;
            padding: 8rem 2rem 6rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Particles background */
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Hero badge */
        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .badge-icon {
            font-size: 1.2rem;
        }

        /* Hero title */
        .hero-title {
            font-size: 6rem;
            margin-bottom: 1.5rem;
            font-weight: 900;
            letter-spacing: -0.03em;
            line-height: 1;
        }

        .gradient-text {
            background: linear-gradient(45deg, #fff, #f0f0f0, #fff);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Hero subtitle */
        .hero-subtitle {
            font-size: 1.4rem;
            margin-bottom: 3rem;
            opacity: 0.95;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .hero-subtitle .highlight {
            color: #fff;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
        }

        /* Hero stats - Glass cards */
        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 3rem auto;
            max-width: 1000px;
        }

        .hero-stat {
            position: relative;
            padding: 2rem 1.5rem;
            text-align: center;
            transition: all 0.3s;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .hero-stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.2);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .hero-stat-value {
            font-size: 3rem;
            font-weight: 800;
            display: inline-block;
            line-height: 1;
        }

        .hero-stat-unit {
            font-size: 1.5rem;
            font-weight: 600;
            margin-left: 0.2rem;
        }

        .hero-stat-label {
            display: block;
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 0.5rem;
            font-weight: 500;
        }

        .stat-progress {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            margin-top: 1rem;
            overflow: hidden;
        }

        .stat-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #fff, #00D9FF);
            border-radius: 2px;
            animation: progressGlow 2s ease infinite;
        }

        @keyframes progressGlow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* CTA Buttons */
        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 3rem;
        }

        .btn {
            padding: 1rem 2.5rem;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.05rem;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .btn-icon {
            font-size: 1.2rem;
        }

        .btn-arrow {
            transition: transform 0.3s;
        }

        .btn:hover .btn-arrow {
            transform: translateX(5px);
        }

        .btn-primary {
            background: white;
            color: var(--primary-color);
        }

        .btn-glow {
            box-shadow: 0 0 30px rgba(255,255,255,0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255,255,255,0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.15);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .btn-glass {
            backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.25);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-3px);
        }

        .btn-github-icon {
            margin-left: 0.3rem;
        }

        /* Hero badges */
        .hero-badges {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 3rem;
        }

        .comparison-badge {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
            align-items: center;
        }

        .comparison-badge.highlight-badge {
            background: rgba(0, 217, 255, 0.2);
            border-color: rgba(0, 217, 255, 0.4);
        }

        .badge-label {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .badge-value {
            font-size: 1.3rem;
            font-weight: 700;
        }

        /* Scroll indicator */
        .scroll-indicator {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            z-index: 2;
        }

        .scroll-icon {
            font-size: 1.5rem;
        }

        .scroll-text {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        /* Performance Comparison Section */
        .performance-comparison {
            background: var(--bg-white);
        }

        .comparison-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .comparison-card {
            background: var(--bg-light);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .comparison-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.1);
        }

        .comparison-card:first-child {
            border-color: var(--primary-color);
            box-shadow: 0 8px 30px rgba(81, 43, 212, 0.15);
        }

        .comparison-header {
            padding: 1.5rem;
            background: var(--bg-white);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .catga-header {
            background: var(--gradient);
            color: white;
        }

        .framework-name {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .framework-badge {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            background: var(--bg-light);
            color: var(--text-color);
            font-weight: 600;
        }

        .best-badge {
            background: rgba(255,255,255,0.3);
            color: white;
            animation: pulse 2s ease infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .comparison-body {
            padding: 2rem 1.5rem;
        }

        .metric {
            margin-bottom: 1.5rem;
        }

        .metric:last-child {
            margin-bottom: 0;
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .metric-value.excellent {
            color: var(--success-color);
        }

        .metric-value.good {
            color: var(--info-color);
        }

        .metric-value.average {
            color: var(--warning-color);
        }

        .metric-value.poor {
            color: #EF4444;
        }

        .metric-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-white);
            border-radius: 4px;
            overflow: hidden;
        }

        .metric-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease;
        }

        .metric-bar-fill.excellent {
            background: linear-gradient(90deg, var(--success-color), #34D399);
        }

        .metric-bar-fill.good {
            background: linear-gradient(90deg, var(--info-color), #60A5FA);
        }

        .metric-bar-fill.average {
            background: linear-gradient(90deg, var(--warning-color), #FCD34D);
        }

        .comparison-footer {
            padding: 1.5rem;
            background: var(--bg-white);
            text-align: center;
        }

        .comparison-cta {
            display: inline-block;
            padding: 0.8rem 2rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
        }

        .primary-cta {
            background: var(--primary-color);
            color: white;
        }

        .primary-cta:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .comparison-note {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Advantages Grid */
        .advantages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .advantage-card {
            background: var(--bg-light);
            padding: 2rem;
            border-radius: 16px;
            text-align: center;
            transition: all 0.3s;
        }

        .advantage-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        }

        .advantage-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .advantage-title {
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            color: var(--text-color);
        }

        .advantage-desc {
            color: var(--text-light);
            line-height: 1.6;
        }

        /* Section Styles */
        .section {
            padding: 5rem 2rem;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--text-color);
        }

        .section-subtitle {
            text-align: center;
            font-size: 1.2rem;
            color: var(--text-light);
            margin-bottom: 3rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Learning Path */
        .learning-path {
            background: var(--bg-white);
        }

        .path-steps {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            max-width: 1000px;
            margin: 0 auto;
        }

        .path-step {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 2rem;
            display: flex;
            gap: 2rem;
            align-items: flex-start;
            transition: all 0.3s;
            border: 2px solid transparent;
            cursor: pointer;
        }

        .path-step:hover {
            border-color: var(--primary-color);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .path-step.active {
            background: var(--bg-white);
            border-color: var(--primary-color);
            box-shadow: 0 4px 15px rgba(81, 43, 212, 0.2);
        }

        .step-number {
            flex-shrink: 0;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-size: 1.5rem;
            color: var(--text-color);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .step-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge-beginner {
            background: #DEF7EC;
            color: #03543F;
        }

        .badge-intermediate {
            background: #FEF3C7;
            color: #92400E;
        }

        .badge-advanced {
            background: #FEE2E2;
            color: #991B1B;
        }

        .badge-expert {
            background: #DBEAFE;
            color: #1E40AF;
        }

        .step-description {
            color: var(--text-light);
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        .step-details {
            display: none;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--border-color);
        }

        .step-details.show {
            display: block;
        }

        .step-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .step-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .step-topics {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .topic-tag {
            background: var(--bg-white);
            border: 1px solid var(--border-color);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--text-color);
        }

        .step-action {
            margin-top: 1rem;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .feature-card {
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .feature-card h3 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .feature-card p {
            color: var(--text-light);
            line-height: 1.7;
        }

        /* Use Cases */
        .use-cases {
            background: var(--bg-white);
        }

        .use-case-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .use-case-tab {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            background: var(--bg-light);
            color: var(--text-color);
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .use-case-tab:hover {
            border-color: var(--primary-color);
        }

        .use-case-tab.active {
            background: var(--primary-color);
            color: white;
        }

        .use-case-content {
            display: none;
            background: var(--bg-light);
            border-radius: 12px;
            padding: 3rem;
        }

        .use-case-content.active {
            display: block;
        }

        .use-case-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: start;
        }

        .use-case-description h3 {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: var(--text-color);
        }

        .use-case-description p {
            color: var(--text-light);
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }

        .use-case-benefits {
            list-style: none;
        }

        .use-case-benefits li {
            padding: 0.5rem 0;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .use-case-benefits li:before {
            content: "✓";
            color: var(--success-color);
            font-weight: 700;
            font-size: 1.2rem;
        }

        .use-case-code {
            background: #1E293B;
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
        }

        .use-case-code pre {
            color: #E2E8F0;
            font-size: 0.9rem;
            line-height: 1.6;
            margin: 0;
        }

        /* Architecture Evolution */
        .architecture-evolution {
            background: var(--bg-white);
        }

        .evolution-timeline {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        .evolution-timeline:before {
            content: '';
            position: absolute;
            left: 30px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--gradient);
        }

        .evolution-step {
            position: relative;
            padding-left: 80px;
            margin-bottom: 3rem;
        }

        .evolution-marker {
            position: absolute;
            left: 14px;
            top: 0;
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: white;
            border: 4px solid var(--primary-color);
        }

        .evolution-content {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 2rem;
        }

        .evolution-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }

        .evolution-subtitle {
            color: var(--text-light);
            margin-bottom: 1rem;
        }

        .evolution-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .evolution-feature {
            padding: 0.5rem;
            background: var(--bg-white);
            border-radius: 4px;
            font-size: 0.9rem;
        }

        /* Code Examples */
        .code-examples {
            background: var(--bg-light);
        }

        .code-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .code-tab {
            padding: 0.75rem 1.5rem;
            border-radius: 8px 8px 0 0;
            background: var(--bg-white);
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            border: 2px solid transparent;
        }

        .code-tab:hover {
            border-color: var(--primary-color);
        }

        .code-tab.active {
            background: #1E293B;
            color: white;
        }

        .code-panel {
            display: none;
            background: #1E293B;
            border-radius: 0 12px 12px 12px;
            padding: 2rem;
            overflow-x: auto;
        }

        .code-panel.active {
            display: block;
        }

        .code-panel pre {
            color: #E2E8F0;
            font-size: 0.95rem;
            line-height: 1.6;
            margin: 0;
        }

        .code-comment { color: #94A3B8; }
        .code-keyword { color: #C792EA; }
        .code-string { color: #C3E88D; }
        .code-type { color: #82AAFF; }
        .code-number { color: #F78C6C; }

        /* Comparison */
        .comparison {
            background: var(--bg-white);
        }

        .comparison-table {
            max-width: 1000px;
            margin: 0 auto;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        th {
            background: var(--gradient);
            color: white;
            padding: 1.5rem 1rem;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 1.25rem 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: var(--bg-light);
        }

        .check-yes {
            color: var(--success-color);
            font-weight: 700;
            font-size: 1.2rem;
        }

        .check-no {
            color: var(--text-light);
            font-size: 1.2rem;
        }

        /* Animation Demo */
        .animation-demo {
            background: var(--bg-white);
        }

        .demo-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .demo-tab {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            background: var(--bg-light);
            color: var(--text-color);
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .demo-tab:hover {
            border-color: var(--primary-color);
        }

        .demo-tab.active {
            background: var(--primary-color);
            color: white;
        }

        .demo-content {
            display: none;
        }

        .demo-content.active {
            display: block;
        }

        .demo-container {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 3rem;
            min-height: 500px;
        }

        .demo-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .demo-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            background: var(--primary-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .demo-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(81, 43, 212, 0.3);
        }

        .demo-btn:disabled {
            background: var(--text-light);
            cursor: not-allowed;
            transform: none;
        }

        .demo-btn.secondary {
            background: var(--bg-white);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        /* Animation Canvas */
        .animation-canvas {
            position: relative;
            height: 400px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        /* Nodes */
        .node {
            position: absolute;
            width: 120px;
            padding: 1rem;
            background: white;
            border: 3px solid var(--primary-color);
            border-radius: 12px;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s;
            z-index: 10;
        }

        .node.active {
            background: var(--primary-color);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(81, 43, 212, 0.4);
        }

        .node.success {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        .node-label {
            font-size: 0.85rem;
            margin-top: 0.5rem;
            opacity: 0.8;
        }

        /* Messages */
        .message {
            position: absolute;
            width: 60px;
            height: 60px;
            background: var(--accent-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            opacity: 0;
            z-index: 20;
        }

        .message.animating {
            animation: moveMessage 2s ease-in-out;
        }

        @keyframes moveMessage {
            0% {
                opacity: 0;
                transform: scale(0);
            }
            20% {
                opacity: 1;
                transform: scale(1);
            }
            80% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0);
            }
        }

        /* Connection Lines */
        .connection {
            position: absolute;
            height: 3px;
            background: var(--border-color);
            transform-origin: left center;
            z-index: 1;
        }

        .connection.active {
            background: var(--accent-color);
            box-shadow: 0 0 10px var(--accent-color);
        }

        /* Flow Arrows */
        .arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 12px solid var(--border-color);
            z-index: 2;
        }

        .arrow.active {
            border-bottom-color: var(--accent-color);
        }

        /* Timeline */
        .demo-timeline {
            margin-top: 2rem;
            padding: 1.5rem;
            background: white;
            border-radius: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        .timeline-item {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: var(--bg-light);
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
            opacity: 0;
            transform: translateX(-20px);
            animation: slideIn 0.3s ease-out forwards;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .timeline-item .time {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .timeline-item .action {
            font-weight: 600;
            color: var(--text-color);
        }

        .timeline-item.success {
            border-left-color: var(--success-color);
        }

        .timeline-item.error {
            border-left-color: #EF4444;
        }

        /* Stats Section */
        .stats {
            background: var(--gradient);
            color: white;
            padding: 4rem 2rem;
        }

        .stats-grid {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 3rem;
            text-align: center;
        }

        .stat-item h3 {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .stat-item p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Footer */
        footer {
            background: var(--text-color);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
        }

        footer a {
            color: var(--accent-color);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Mobile Navigation */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            color: var(--text-color);
        }

        .mobile-nav {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            padding: 2rem;
            overflow-y: auto;
        }

        .mobile-nav.active {
            display: flex;
            flex-direction: column;
        }

        .mobile-nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .mobile-nav-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: white;
            cursor: pointer;
        }

        .mobile-nav-links {
            list-style: none;
            padding: 0;
        }

        .mobile-nav-links li {
            margin-bottom: 1.5rem;
        }

        .mobile-nav-links a {
            color: white;
            text-decoration: none;
            font-size: 1.5rem;
            font-weight: 600;
            display: block;
            padding: 1rem;
            border-radius: 8px;
            transition: background 0.3s;
        }

        .mobile-nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
            .container {
                padding: 0 1.5rem;
            }

            .section {
                padding: 3rem 1.5rem;
            }

            .hero h1 {
                font-size: 3rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .demo-container {
                padding: 2rem;
            }

            .animation-canvas {
                height: 350px;
            }

            .node {
                width: 100px;
                padding: 0.75rem;
                font-size: 0.85rem;
            }

            .message {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }

        @media (max-width: 768px) {
            /* Typography */
            body {
                font-size: 14px;
            }

            .hero-title {
                font-size: 3rem !important;
                line-height: 1.2;
            }

            .hero-subtitle {
                font-size: 1rem !important;
                padding: 0 1rem;
            }

            .hero p {
                font-size: 1rem;
                padding: 0 1rem;
            }

            .hero-stats {
                gap: 1.5rem;
            }

            .hero-stat-value {
                font-size: 2rem;
            }

            .hero-stat-label {
                font-size: 0.9rem;
            }

            .hero-badges {
                flex-direction: column;
                gap: 1rem;
                padding: 0 1rem;
            }

            .comparison-badge {
                width: 100%;
            }

            .section-title {
                font-size: 1.75rem;
            }

            .section-subtitle {
                font-size: 1rem;
                padding: 0 1rem;
            }

            /* Header & Navigation */
            nav {
                padding: 1rem;
            }

            .logo {
                font-size: 1.5rem;
            }

            .nav-links {
                display: none;
            }

            .mobile-menu-btn {
                display: block;
            }

            .back-to-top {
                bottom: 1rem;
                right: 1rem;
                width: 45px;
                height: 45px;
                font-size: 1.3rem;
            }

            /* Buttons */
            .btn {
                padding: 0.75rem 1.5rem;
                font-size: 0.9rem;
            }

            .cta-buttons {
                flex-direction: column;
                padding: 0 1rem;
                width: 100%;
            }

            .cta-buttons .btn {
                width: 100%;
                max-width: 300px;
            }

            /* Demo Section */
            .demo-tabs {
                gap: 0.5rem;
                padding: 0 0.5rem;
            }

            .demo-tab {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }

            .demo-container {
                padding: 1.5rem 1rem;
                min-height: 400px;
            }

            .demo-controls {
                flex-direction: column;
                gap: 0.75rem;
            }

            .demo-btn {
                width: 100%;
                max-width: 200px;
            }

            .animation-canvas {
                height: 300px;
            }

            .node {
                width: 80px;
                padding: 0.5rem;
                font-size: 0.75rem;
                border-width: 2px;
            }

            .node-label {
                font-size: 0.7rem;
            }

            .message {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }

            .demo-timeline {
                max-height: 150px;
                padding: 1rem;
            }

            .timeline-item {
                padding: 0.5rem;
                font-size: 0.85rem;
            }

            /* Learning Path */
            .path-step {
                flex-direction: column;
                padding: 1.5rem;
                gap: 1rem;
            }

            .step-number {
                align-self: flex-start;
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }

            .step-title {
                font-size: 1.25rem;
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .step-description {
                font-size: 0.9rem;
            }

            .step-meta {
                flex-direction: column;
                gap: 0.5rem;
            }

            .step-topics {
                gap: 0.35rem;
            }

            .topic-tag {
                font-size: 0.75rem;
                padding: 0.2rem 0.6rem;
            }

            .step-action {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }

            .step-action .btn {
                width: 100%;
            }

            /* Features */
            .features-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .feature-card {
                padding: 1.5rem;
            }

            .feature-icon {
                font-size: 2.5rem;
            }

            .feature-card h3 {
                font-size: 1.25rem;
            }

            /* Use Cases */
            .use-case-tabs {
                gap: 0.5rem;
                padding: 0 0.5rem;
            }

            .use-case-tab {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
                flex: 1;
                min-width: 0;
            }

            .use-case-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .use-case-description h3 {
                font-size: 1.5rem;
            }

            .use-case-description p {
                font-size: 0.9rem;
            }

            .use-case-code {
                padding: 1rem;
                overflow-x: auto;
            }

            .use-case-code pre {
                font-size: 0.75rem;
            }

            /* Architecture Evolution */
            .evolution-timeline:before {
                left: 20px;
            }

            .evolution-step {
                padding-left: 60px;
                margin-bottom: 2rem;
            }

            .evolution-marker {
                left: 9px;
                width: 24px;
                height: 24px;
                border-width: 3px;
            }

            .evolution-content {
                padding: 1.5rem;
            }

            .evolution-title {
                font-size: 1.25rem;
            }

            .evolution-subtitle {
                font-size: 0.9rem;
            }

            .evolution-features {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .evolution-feature {
                font-size: 0.85rem;
            }

            /* Code Examples */
            .code-tabs {
                gap: 0.35rem;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .code-tab {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
                white-space: nowrap;
                flex-shrink: 0;
            }

            .code-panel {
                padding: 1rem;
                border-radius: 8px;
            }

            .code-panel pre {
                font-size: 0.75rem;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            /* Comparison Table */
            .comparison-table {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: 0.75rem 0.5rem;
                white-space: nowrap;
            }

            /* Stats */
            .stats {
                padding: 3rem 1rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 2rem;
            }

            .stat-item h3 {
                font-size: 2rem;
            }

            .stat-item p {
                font-size: 0.9rem;
            }

            /* Footer */
            footer {
                padding: 2rem 1rem;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 1.75rem;
            }

            .hero p {
                font-size: 0.9rem;
            }

            .hero-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }

            .section-title {
                font-size: 1.5rem;
            }

            .demo-tab {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
            }

            .animation-canvas {
                height: 250px;
            }

            .node {
                width: 70px;
                padding: 0.4rem;
                font-size: 0.7rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .use-case-tab {
                font-size: 0.75rem;
                padding: 0.5rem 0.75rem;
            }
        }

        /* Touch Improvements */
        @media (hover: none) and (pointer: coarse) {
            /* Larger touch targets */
            .btn,
            .demo-btn,
            .demo-tab,
            .use-case-tab,
            .code-tab {
                min-height: 44px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
            }

            /* Remove hover effects on touch devices */
            .btn:hover,
            .demo-btn:hover,
            .feature-card:hover,
            .path-step:hover {
                transform: none;
            }

            /* Better tap highlighting */
            * {
                -webkit-tap-highlight-color: rgba(81, 43, 212, 0.2);
            }
        }

        /* Landscape Mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            .hero {
                padding: 3rem 2rem;
            }

            .animation-canvas {
                height: 250px;
            }

            .demo-container {
                min-height: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav>
            <div class="logo">⚡ Catga</div>
            <ul class="nav-links">
                <li><a href="#demo">动画演示</a></li>
                <li><a href="#performance">性能对比</a></li>
                <li><a href="#learning">学习路径</a></li>
                <li><a href="api.html">📖 API文档</a></li>
                <li><a href="https://github.com/Cricle/Catga" target="_blank">GitHub</a></li>
            </ul>
            <div class="nav-actions">
                <button class="theme-toggle-btn" onclick="toggleTheme()" title="切换主题">
                    <span class="theme-icon light-icon">🌙</span>
                    <span class="theme-icon dark-icon">☀️</span>
                </button>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰</button>
            </div>
        </nav>
    </header>

    <!-- Mobile Navigation -->
    <div class="mobile-nav" id="mobileNav">
        <div class="mobile-nav-header">
            <div class="logo">⚡ Catga</div>
            <button class="mobile-nav-close" onclick="toggleMobileMenu()">✕</button>
        </div>
        <ul class="mobile-nav-links">
            <li><a href="#demo" onclick="toggleMobileMenu()">🎬 动画演示</a></li>
            <li><a href="#performance" onclick="toggleMobileMenu()">📊 性能对比</a></li>
            <li><a href="#learning" onclick="toggleMobileMenu()">🎓 学习路径</a></li>
            <li><a href="#use-cases" onclick="toggleMobileMenu()">💼 使用场景</a></li>
            <li><a href="api.html">📖 API 文档</a></li>
            <li><a href="#examples" onclick="toggleMobileMenu()">💻 代码示例</a></li>
            <li><a href="https://github.com/Cricle/Catga" target="_blank">💻 GitHub</a></li>
            <li><a href="../articles/getting-started.html">📚 完整文档</a></li>
        </ul>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <!-- Background particles -->
        <div id="particles-js"></div>
        
        <div class="hero-content">
            <div class="hero-badge animate__animated animate__fadeInDown">
                <span class="badge-icon">⚡</span>
                <span class="badge-text">高性能 CQRS 框架</span>
            </div>
            
            <h1 class="hero-title animate__animated animate__fadeInUp">
                <span class="gradient-text">Catga</span>
            </h1>
            
            <p class="hero-subtitle animate__animated animate__fadeInUp animate__delay-1s">
                现代化、高性能的 <span class="highlight">.NET CQRS/Event Sourcing</span> 框架
                <br>
                支持 <span class="highlight">Native AOT</span>，零反射，<span class="highlight">生产就绪</span>
            </p>

            <div class="hero-stats animate__animated animate__fadeInUp animate__delay-2s">
                <div class="hero-stat glass-card">
                    <div class="stat-icon">⚡</div>
                    <span class="hero-stat-value" data-target="0.1">&lt; 1</span>
                    <span class="hero-stat-unit">μs</span>
                    <span class="hero-stat-label">命令处理延迟</span>
                    <div class="stat-progress">
                        <div class="stat-progress-bar" style="width: 95%"></div>
                    </div>
                </div>
                <div class="hero-stat glass-card">
                    <div class="stat-icon">🚀</div>
                    <span class="hero-stat-value" data-target="1000000">0</span>
                    <span class="hero-stat-unit">+</span>
                    <span class="hero-stat-label">每秒吞吐量</span>
                    <div class="stat-progress">
                        <div class="stat-progress-bar" style="width: 100%"></div>
                    </div>
                </div>
                <div class="hero-stat glass-card">
                    <div class="stat-icon">✨</div>
                    <span class="hero-stat-value" data-target="100">0</span>
                    <span class="hero-stat-unit">%</span>
                    <span class="hero-stat-label">AOT 兼容</span>
                    <div class="stat-progress">
                        <div class="stat-progress-bar" style="width: 100%"></div>
                    </div>
                </div>
                <div class="hero-stat glass-card">
                    <div class="stat-icon">🧪</div>
                    <span class="hero-stat-value" data-target="194">0</span>
                    <span class="hero-stat-unit"></span>
                    <span class="hero-stat-label">测试覆盖</span>
                    <div class="stat-progress">
                        <div class="stat-progress-bar" style="width: 98%"></div>
                    </div>
                </div>
            </div>

            <div class="cta-buttons animate__animated animate__fadeInUp animate__delay-3s">
                <a href="#learning" class="btn btn-primary btn-glow">
                    <span class="btn-icon">🎓</span>
                    <span>开始学习</span>
                    <span class="btn-arrow">→</span>
                </a>
                <a href="https://github.com/Cricle/Catga" class="btn btn-secondary btn-glass" target="_blank">
                    <span class="btn-icon">💻</span>
                    <span>查看源码</span>
                    <svg class="btn-github-icon" viewBox="0 0 16 16" width="16" height="16">
                        <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                </a>
                <a href="../articles/getting-started.html" class="btn btn-secondary btn-glass">
                    <span class="btn-icon">📚</span>
                    <span>完整文档</span>
                </a>
            </div>

            <!-- Framework comparison badges -->
            <div class="hero-badges animate__animated animate__fadeInUp animate__delay-4s">
                <div class="comparison-badge">
                    <span class="badge-label">vs MediatR</span>
                    <span class="badge-value">10x 更快</span>
                </div>
                <div class="comparison-badge">
                    <span class="badge-label">vs MassTransit</span>
                    <span class="badge-value">5x 更快</span>
                </div>
                <div class="comparison-badge highlight-badge">
                    <span class="badge-label">内存分配</span>
                    <span class="badge-value">-94%</span>
                </div>
            </div>
        </div>

        <!-- Scroll indicator -->
        <div class="scroll-indicator animate__animated animate__bounce animate__infinite animate__slow">
            <div class="scroll-icon">↓</div>
            <div class="scroll-text">向下滚动探索更多</div>
        </div>
    </section>

    <!-- Animation Demo Section -->
    <section id="demo" class="section animation-demo">
        <div class="container">
            <h2 class="section-title">🎬 动画演示</h2>
            <p class="section-subtitle">直观了解 Catga 核心流程如何运转</p>

            <div class="demo-tabs">
                <div class="demo-tab active" onclick="switchDemo(0)">CQRS 流程</div>
                <div class="demo-tab" onclick="switchDemo(1)">事件驱动</div>
                <div class="demo-tab" onclick="switchDemo(2)">Outbox 模式</div>
                <div class="demo-tab" onclick="switchDemo(3)">分布式追踪</div>
            </div>

            <!-- Demo 1: CQRS Flow -->
            <div class="demo-content active">
                <div class="demo-container">
                    <div class="demo-controls">
                        <button class="demo-btn" onclick="startCQRSDemo()">▶️ 播放</button>
                        <button class="demo-btn secondary" onclick="resetCQRSDemo()">🔄 重置</button>
                    </div>
                    <div id="cqrs-canvas" class="animation-canvas"></div>
                    <div id="cqrs-timeline" class="demo-timeline"></div>
                </div>
            </div>

            <!-- Demo 2: Event-Driven -->
            <div class="demo-content">
                <div class="demo-container">
                    <div class="demo-controls">
                        <button class="demo-btn" onclick="startEventDemo()">▶️ 播放</button>
                        <button class="demo-btn secondary" onclick="resetEventDemo()">🔄 重置</button>
                    </div>
                    <div id="event-canvas" class="animation-canvas"></div>
                    <div id="event-timeline" class="demo-timeline"></div>
                </div>
            </div>

            <!-- Demo 3: Outbox Pattern -->
            <div class="demo-content">
                <div class="demo-container">
                    <div class="demo-controls">
                        <button class="demo-btn" onclick="startOutboxDemo()">▶️ 播放</button>
                        <button class="demo-btn secondary" onclick="resetOutboxDemo()">🔄 重置</button>
                    </div>
                    <div id="outbox-canvas" class="animation-canvas"></div>
                    <div id="outbox-timeline" class="demo-timeline"></div>
                </div>
            </div>

            <!-- Demo 4: Distributed Tracing -->
            <div class="demo-content">
                <div class="demo-container">
                    <div class="demo-controls">
                        <button class="demo-btn" onclick="startTracingDemo()">▶️ 播放</button>
                        <button class="demo-btn secondary" onclick="resetTracingDemo()">🔄 重置</button>
                    </div>
                    <div id="tracing-canvas" class="animation-canvas"></div>
                    <div id="tracing-timeline" class="demo-timeline"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Performance Comparison Section -->
    <section id="performance" class="section performance-comparison">
        <div class="container">
            <h2 class="section-title">📊 性能对比</h2>
            <p class="section-subtitle">Catga 在性能和资源利用率上全面领先主流框架</p>

            <!-- Comparison Table -->
            <div class="comparison-container">
                <div class="comparison-card">
                    <div class="comparison-header catga-header">
                        <h3 class="framework-name">🐱 Catga</h3>
                        <div class="framework-badge best-badge">最佳选择</div>
                    </div>
                    <div class="comparison-body">
                        <div class="metric">
                            <div class="metric-label">命令延迟</div>
                            <div class="metric-value excellent">< 1μs</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill excellent" style="width: 100%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">内存分配</div>
                            <div class="metric-value excellent">24B</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill excellent" style="width: 5%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">吞吐量</div>
                            <div class="metric-value excellent">1.2M ops/s</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill excellent" style="width: 100%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">AOT 支持</div>
                            <div class="metric-value excellent">✅ 100%</div>
                        </div>
                    </div>
                    <div class="comparison-footer">
                        <a href="#learning" class="comparison-cta primary-cta">开始使用 →</a>
                    </div>
                </div>

                <div class="comparison-card">
                    <div class="comparison-header">
                        <h3 class="framework-name">MediatR</h3>
                        <div class="framework-badge">流行框架</div>
                    </div>
                    <div class="comparison-body">
                        <div class="metric">
                            <div class="metric-label">命令延迟</div>
                            <div class="metric-value good">~10μs</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill good" style="width: 10%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">内存分配</div>
                            <div class="metric-value average">408B</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill average" style="width: 85%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">吞吐量</div>
                            <div class="metric-value good">~120K ops/s</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill good" style="width: 10%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">AOT 支持</div>
                            <div class="metric-value poor">⚠️ 部分</div>
                        </div>
                    </div>
                    <div class="comparison-footer">
                        <div class="comparison-note">反射密集</div>
                    </div>
                </div>

                <div class="comparison-card">
                    <div class="comparison-header">
                        <h3 class="framework-name">MassTransit</h3>
                        <div class="framework-badge">企业级</div>
                    </div>
                    <div class="comparison-body">
                        <div class="metric">
                            <div class="metric-label">命令延迟</div>
                            <div class="metric-value average">~5μs</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill average" style="width: 20%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">内存分配</div>
                            <div class="metric-value average">320B</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill average" style="width: 67%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">吞吐量</div>
                            <div class="metric-value average">~250K ops/s</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill average" style="width: 21%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">AOT 支持</div>
                            <div class="metric-value poor">❌ 不支持</div>
                        </div>
                    </div>
                    <div class="comparison-footer">
                        <div class="comparison-note">功能丰富但复杂</div>
                    </div>
                </div>
            </div>

            <!-- Key advantages -->
            <div class="advantages-grid">
                <div class="advantage-card">
                    <div class="advantage-icon">⚡</div>
                    <h4 class="advantage-title">极致性能</h4>
                    <p class="advantage-desc">零分配设计，< 1μs 延迟，10x MediatR 性能</p>
                </div>
                <div class="advantage-card">
                    <div class="advantage-icon">💎</div>
                    <h4 class="advantage-title">Native AOT</h4>
                    <p class="advantage-desc">完全兼容 AOT，启动快90%，内存省60%</p>
                </div>
                <div class="advantage-card">
                    <div class="advantage-icon">🎯</div>
                    <h4 class="advantage-title">零反射</h4>
                    <p class="advantage-desc">源生成器自动注册，消除运行时开销</p>
                </div>
                <div class="advantage-card">
                    <div class="advantage-icon">🛡️</div>
                    <h4 class="advantage-title">类型安全</h4>
                    <p class="advantage-desc">编译时检查，IDE 智能提示，杜绝运行时错误</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Learning Path Section -->
    <section id="learning" class="section learning-path">
        <div class="container">
            <h2 class="section-title">🎓 多步进阶学习路径</h2>
            <p class="section-subtitle">从零基础到架构专家，系统化掌握 Catga 框架和 CQRS 架构</p>

            <div class="path-steps">
                <!-- Step 1: Beginner -->
                <div class="path-step" onclick="toggleStep(this)">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-title">
                            快速上手
                            <span class="step-badge badge-beginner">初级</span>
                        </div>
                        <div class="step-description">
                            学习 Catga 的核心概念，完成第一个 Hello World 应用。理解 CQRS 的基本思想，掌握命令、查询和事件的区别。
                        </div>
                        <div class="step-details">
                            <div class="step-meta">
                                <div class="step-meta-item">⏱️ 学习时间: 1-2 小时</div>
                                <div class="step-meta-item">📚 前置知识: C# 基础，ASP.NET Core</div>
                                <div class="step-meta-item">🎯 完成度: 5 个任务</div>
                            </div>
                            <div class="step-topics">
                                <span class="topic-tag">安装 NuGet 包</span>
                                <span class="topic-tag">配置服务</span>
                                <span class="topic-tag">定义命令</span>
                                <span class="topic-tag">实现 Handler</span>
                                <span class="topic-tag">发送命令</span>
                            </div>
                            <div class="step-action">
                                <a href="#step1-code" class="btn btn-primary">查看代码示例</a>
                                <a href="../articles/getting-started.html" class="btn btn-secondary">完整教程</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Beginner+ -->
                <div class="path-step" onclick="toggleStep(this)">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <div class="step-title">
                            事件驱动架构
                            <span class="step-badge badge-beginner">初级+</span>
                        </div>
                        <div class="step-description">
                            深入理解事件驱动架构，学习如何发布和订阅事件。掌握多个 Handler 处理同一事件的并发模式，理解事件的异步特性。
                        </div>
                        <div class="step-details">
                            <div class="step-meta">
                                <div class="step-meta-item">⏱️ 学习时间: 2-3 小时</div>
                                <div class="step-meta-item">📚 前置知识: 完成步骤 1</div>
                                <div class="step-meta-item">🎯 完成度: 7 个任务</div>
                            </div>
                            <div class="step-topics">
                                <span class="topic-tag">定义事件</span>
                                <span class="topic-tag">发布事件</span>
                                <span class="topic-tag">订阅事件</span>
                                <span class="topic-tag">多 Handler 处理</span>
                                <span class="topic-tag">事件溯源基础</span>
                                <span class="topic-tag">异常处理</span>
                            </div>
                            <div class="step-action">
                                <a href="#step2-code" class="btn btn-primary">查看代码示例</a>
                                <a href="../articles/event-driven.html" class="btn btn-secondary">完整教程</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Intermediate -->
                <div class="path-step" onclick="toggleStep(this)">
                    <div class="number">3</div>
                    <div class="step-content">
                        <div class="step-title">
                            传输层与持久化
                            <span class="step-badge badge-intermediate">中级</span>
                        </div>
                        <div class="step-description">
                            学习如何集成 Redis 和 NATS 传输层，理解 QoS 0 和 QoS 1 的区别。掌握 Outbox/Inbox 模式，确保消息可靠传递和幂等性处理。
                        </div>
                        <div class="step-details">
                            <div class="step-meta">
                                <div class="step-meta-item">⏱️ 学习时间: 4-6 小时</div>
                                <div class="step-meta-item">📚 前置知识: 完成步骤 2，了解 Redis/NATS</div>
                                <div class="step-meta-item">🎯 完成度: 10 个任务</div>
                            </div>
                            <div class="step-topics">
                                <span class="topic-tag">Redis Transport</span>
                                <span class="topic-tag">NATS Transport</span>
                                <span class="topic-tag">QoS 0 vs QoS 1</span>
                                <span class="topic-tag">Outbox 模式</span>
                                <span class="topic-tag">Inbox 模式</span>
                                <span class="topic-tag">幂等性保证</span>
                                <span class="topic-tag">消息重试</span>
                                <span class="topic-tag">死信队列</span>
                            </div>
                            <div class="step-action">
                                <a href="#step3-code" class="btn btn-primary">查看代码示例</a>
                                <a href="../articles/transport-persistence.html" class="btn btn-secondary">完整教程</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Intermediate+ -->
                <div class="path-step" onclick="toggleStep(this)">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <div class="step-title">
                            微服务与分布式
                            <span class="step-badge badge-intermediate">中级+</span>
                        </div>
                        <div class="step-description">
                            构建分布式微服务系统，学习服务间通信模式。掌握分布式追踪、监控和诊断，使用 OpenTelemetry 实现可观测性。
                        </div>
                        <div class="step-details">
                            <div class="step-meta">
                                <div class="step-meta-item">⏱️ 学习时间: 6-8 小时</div>
                                <div class="step-meta-item">📚 前置知识: 完成步骤 3，微服务基础</div>
                                <div class="step-meta-item">🎯 完成度: 12 个任务</div>
                            </div>
                            <div class="step-topics">
                                <span class="topic-tag">服务拆分</span>
                                <span class="topic-tag">RPC 通信</span>
                                <span class="topic-tag">分布式追踪</span>
                                <span class="topic-tag">OpenTelemetry</span>
                                <span class="topic-tag">健康检查</span>
                                <span class="topic-tag">服务发现</span>
                                <span class="topic-tag">熔断降级</span>
                                <span class="topic-tag">负载均衡</span>
                            </div>
                            <div class="step-action">
                                <a href="#step4-code" class="btn btn-primary">查看代码示例</a>
                                <a href="../articles/microservices.html" class="btn btn-secondary">完整教程</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Advanced -->
                <div class="path-step" onclick="toggleStep(this)">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <div class="step-title">
                            事件溯源与 CQRS 进阶
                            <span class="step-badge badge-advanced">高级</span>
                        </div>
                        <div class="step-description">
                            深入掌握 Event Sourcing 和 CQRS 模式，学习聚合根设计、快照机制和读写分离。理解最终一致性和分布式事务。
                        </div>
                        <div class="step-details">
                            <div class="step-meta">
                                <div class="step-meta-item">⏱️ 学习时间: 8-12 小时</div>
                                <div class="step-meta-item">📚 前置知识: 完成步骤 4，DDD 基础</div>
                                <div class="step-meta-item">🎯 完成度: 15 个任务</div>
                            </div>
                            <div class="step-topics">
                                <span class="topic-tag">Event Sourcing</span>
                                <span class="topic-tag">聚合根设计</span>
                                <span class="topic-tag">快照机制</span>
                                <span class="topic-tag">事件版本控制</span>
                                <span class="topic-tag">读写分离</span>
                                <span class="topic-tag">物化视图</span>
                                <span class="topic-tag">最终一致性</span>
                                <span class="topic-tag">Saga 模式</span>
                            </div>
                            <div class="step-action">
                                <a href="#step5-code" class="btn btn-primary">查看代码示例</a>
                                <a href="../articles/event-sourcing.html" class="btn btn-secondary">完整教程</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 6: Advanced+ -->
                <div class="path-step" onclick="toggleStep(this)">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <div class="step-title">
                            性能优化与 AOT
                            <span class="step-badge badge-advanced">高级+</span>
                        </div>
                        <div class="step-description">
                            掌握高性能优化技巧，学习 Native AOT 部署。理解零反射、零分配的设计原则，使用 BenchmarkDotNet 进行性能测试。
                        </div>
                        <div class="step-details">
                            <div class="step-meta">
                                <div class="step-meta-item">⏱️ 学习时间: 6-10 小时</div>
                                <div class="step-meta-item">📚 前置知识: 完成步骤 5，性能调优基础</div>
                                <div class="step-meta-item">🎯 完成度: 12 个任务</div>
                            </div>
                            <div class="step-topics">
                                <span class="topic-tag">Native AOT</span>
                                <span class="topic-tag">零反射设计</span>
                                <span class="topic-tag">Source Generator</span>
                                <span class="topic-tag">ArrayPool 优化</span>
                                <span class="topic-tag">MemoryPack</span>
                                <span class="topic-tag">性能基准测试</span>
                                <span class="topic-tag">内存诊断</span>
                                <span class="topic-tag">CPU 分析</span>
                            </div>
                            <div class="step-action">
                                <a href="#step6-code" class="btn btn-primary">查看代码示例</a>
                                <a href="../articles/aot-deployment.html" class="btn btn-secondary">完整教程</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 7: Expert -->
                <div class="path-step" onclick="toggleStep(this)">
                    <div class="step-number">7</div>
                    <div class="step-content">
                        <div class="step-title">
                            生产级架构实践
                            <span class="step-badge badge-expert">专家</span>
                        </div>
                        <div class="step-description">
                            构建企业级生产系统，掌握高可用、容灾、安全等方面的最佳实践。学习 .NET Aspire 集成、多租户、审计日志等企业功能。
                        </div>
                        <div class="step-details">
                            <div class="step-meta">
                                <div class="step-meta-item">⏱️ 学习时间: 10-15 小时</div>
                                <div class="step-meta-item">📚 前置知识: 完成步骤 6，生产运维经验</div>
                                <div class="step-meta-item">🎯 完成度: 18 个任务</div>
                            </div>
                            <div class="step-topics">
                                <span class="topic-tag">.NET Aspire</span>
                                <span class="topic-tag">高可用架构</span>
                                <span class="topic-tag">容灾方案</span>
                                <span class="topic-tag">多租户</span>
                                <span class="topic-tag">审计日志</span>
                                <span class="topic-tag">安全加密</span>
                                <span class="topic-tag">GDPR 合规</span>
                                <span class="topic-tag">混沌工程</span>
                                <span class="topic-tag">压力测试</span>
                                <span class="topic-tag">CI/CD</span>
                            </div>
                            <div class="step-action">
                                <a href="#step7-code" class="btn btn-primary">查看代码示例</a>
                                <a href="../articles/production-ready.html" class="btn btn-secondary">完整教程</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="section">
        <div class="container">
            <h2 class="section-title">🎯 核心特性</h2>
            <p class="section-subtitle">强大的功能，优雅的 API，生产就绪的框架</p>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">🚀</div>
                    <h3>极致性能</h3>
                    <p>零反射、零分配、Native AOT 支持。命令处理 &lt; 1μs，吞吐量 &gt; 1M ops/s。ArrayPool 优化，MemoryPack 序列化。</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">🔌</div>
                    <h3>可插拔架构</h3>
                    <p>支持 Redis（QoS 0/1）、NATS、InMemory 传输层。轻松切换持久化和传输实现，适应不同场景需求。</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">📦</div>
                    <h3>Outbox/Inbox</h3>
                    <p>内置 Outbox 和 Inbox 模式，确保消息可靠传递和幂等性处理。批量发送优化，死信队列支持。</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">🎨</div>
                    <h3>可观测性</h3>
                    <p>完整的分布式追踪和指标监控。支持 OpenTelemetry、Jaeger、Prometheus、Grafana。W3C Trace Context 标准。</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">⚙️</div>
                    <h3>Source Generator</h3>
                    <p>编译时自动生成 Handler 注册代码。零配置，零运行时开销。智能分析，自动发现 Handler。</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">🌐</div>
                    <h3>.NET Aspire</h3>
                    <p>深度集成 .NET Aspire。统一资源管理，Aspire Dashboard 可视化。健康检查，服务发现。</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">🔒</div>
                    <h3>生产就绪</h3>
                    <p>194 个单元测试，100% 通过。完整的异常处理，详细的日志记录。支持重试、熔断、限流。</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">📚</div>
                    <h3>完整文档</h3>
                    <p>49 个文档文件，从入门到专家。代码示例齐全，最佳实践指南。中英文双语支持（计划中）。</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">🛠️</div>
                    <h3>开发体验</h3>
                    <p>优雅的 Fluent API，智能的类型推断。自动注册 Handler，零样板代码。IDE 友好，完善的 IntelliSense。</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Use Cases Section -->
    <section id="use-cases" class="section use-cases">
        <div class="container">
            <h2 class="section-title">💼 使用场景</h2>
            <p class="section-subtitle">从电商到金融，从 IoT 到游戏，Catga 适用于各种场景</p>

            <div class="use-case-tabs">
                <div class="use-case-tab active" onclick="switchUseCase(0)">电商系统</div>
                <div class="use-case-tab" onclick="switchUseCase(1)">金融交易</div>
                <div class="use-case-tab" onclick="switchUseCase(2)">物联网</div>
                <div class="use-case-tab" onclick="switchUseCase(3)">游戏后端</div>
            </div>

            <!-- E-Commerce -->
            <div class="use-case-content active">
                <div class="use-case-grid">
                    <div class="use-case-description">
                        <h3>🛒 电商订单系统</h3>
                        <p>使用 Catga 构建高性能电商系统，支持订单处理、库存管理、支付集成。Event Sourcing 确保订单状态可追溯，Outbox 模式保证订单事件可靠发送到下游系统（库存、物流、通知）。</p>
                        <ul class="use-case-benefits">
                            <li>订单状态完整追溯</li>
                            <li>库存扣减幂等性保证</li>
                            <li>支付回调可靠处理</li>
                            <li>实时库存同步</li>
                            <li>高并发秒杀支持</li>
                        </ul>
                    </div>
                    <div class="use-case-code">
                        <pre><code><span class="code-comment">// 创建订单命令</span>
<span class="code-keyword">var</span> command = <span class="code-keyword">new</span> <span class="code-type">CreateOrderCommand</span>(
    ProductId: <span class="code-string">"prod-123"</span>,
    Quantity: <span class="code-number">5</span>,
    UserId: <span class="code-string">"user-456"</span>
);

<span class="code-comment">// 发送命令到订单服务</span>
<span class="code-keyword">var</span> result = <span class="code-keyword">await</span> mediator.SendAsync&lt;
    <span class="code-type">CreateOrderCommand</span>,
    <span class="code-type">Order</span>
&gt;(command);

<span class="code-keyword">if</span> (result.IsSuccess)
{
    <span class="code-comment">// 自动发布 OrderCreatedEvent</span>
    <span class="code-comment">// → 库存服务扣减库存</span>
    <span class="code-comment">// → 通知服务发送确认邮件</span>
    <span class="code-comment">// → 物流服务创建发货单</span>
}</code></pre>
                    </div>
                </div>
            </div>

            <!-- Finance -->
            <div class="use-case-content">
                <div class="use-case-grid">
                    <div class="use-case-description">
                        <h3>💰 金融交易系统</h3>
                        <p>构建高可靠金融交易平台，支持转账、支付、风控。Event Sourcing 提供完整的审计日志，每笔交易可追溯。Saga 模式处理分布式事务，确保账户余额一致性。</p>
                        <ul class="use-case-benefits">
                            <li>交易记录不可篡改</li>
                            <li>分布式事务一致性</li>
                            <li>实时风控检测</li>
                            <li>账户余额精确计算</li>
                            <li>审计日志完整性</li>
                        </ul>
                    </div>
                    <div class="use-case-code">
                        <pre><code><span class="code-comment">// 转账命令</span>
<span class="code-keyword">var</span> command = <span class="code-keyword">new</span> <span class="code-type">TransferMoneyCommand</span>(
    FromAccount: <span class="code-string">"acc-001"</span>,
    ToAccount: <span class="code-string">"acc-002"</span>,
    Amount: <span class="code-number">1000.00m</span>,
    Currency: <span class="code-string">"USD"</span>
);

<span class="code-comment">// Saga 模式处理</span>
<span class="code-comment">// 1. 冻结源账户金额</span>
<span class="code-comment">// 2. 风控检测</span>
<span class="code-comment">// 3. 扣减源账户</span>
<span class="code-comment">// 4. 增加目标账户</span>
<span class="code-comment">// 5. 发送通知</span>
<span class="code-keyword">var</span> result = <span class="code-keyword">await</span> mediator.SendAsync&lt;
    <span class="code-type">TransferMoneyCommand</span>,
    <span class="code-type">Transaction</span>
&gt;(command);</code></pre>
                    </div>
                </div>
            </div>

            <!-- IoT -->
            <div class="use-case-content">
                <div class="use-case-grid">
                    <div class="use-case-description">
                        <h3>📡 物联网平台</h3>
                        <p>处理海量设备数据上报，支持实时告警、数据分析。NATS 传输层提供低延迟消息传递，QoS 1 确保关键数据不丢失。Event Sourcing 存储设备状态历史，支持时序查询。</p>
                        <ul class="use-case-benefits">
                            <li>百万设备并发连接</li>
                            <li>毫秒级数据上报</li>
                            <li>实时告警触发</li>
                            <li>设备状态追溯</li>
                            <li>数据聚合分析</li>
                        </ul>
                    </div>
                    <div class="use-case-code">
                        <pre><code><span class="code-comment">// 设备数据上报事件</span>
<span class="code-keyword">var</span> @event = <span class="code-keyword">new</span> <span class="code-type">DeviceDataReportedEvent</span>(
    DeviceId: <span class="code-string">"device-12345"</span>,
    Temperature: <span class="code-number">85.5</span>,
    Humidity: <span class="code-number">60.2</span>,
    Timestamp: DateTime.UtcNow
);

<span class="code-comment">// 发布事件 (NATS QoS 1)</span>
<span class="code-keyword">await</span> mediator.PublishAsync(@event);

<span class="code-comment">// 自动触发多个 Handler:</span>
<span class="code-comment">// → 告警服务检测异常温度</span>
<span class="code-comment">// → 存储服务写入时序数据库</span>
<span class="code-comment">// → 分析服务更新实时统计</span></code></pre>
                    </div>
                </div>
            </div>

            <!-- Gaming -->
            <div class="use-case-content">
                <div class="use-case-grid">
                    <div class="use-case-description">
                        <h3>🎮 游戏后端服务</h3>
                        <p>构建低延迟游戏服务器，支持玩家操作、战斗计算、排行榜。Redis 传输层提供毫秒级响应，InMemory 缓存优化热点数据。Event Sourcing 记录玩家行为，支持回放和作弊检测。</p>
                        <ul class="use-case-benefits">
                            <li>毫秒级响应延迟</li>
                            <li>百万玩家在线</li>
                            <li>实时排行榜更新</li>
                            <li>玩家行为回放</li>
                            <li>作弊检测分析</li>
                        </ul>
                    </div>
                    <div class="use-case-code">
                        <pre><code><span class="code-comment">// 玩家攻击命令</span>
<span class="code-keyword">var</span> command = <span class="code-keyword">new</span> <span class="code-type">PlayerAttackCommand</span>(
    AttackerId: <span class="code-string">"player-001"</span>,
    TargetId: <span class="code-string">"player-002"</span>,
    SkillId: <span class="code-string">"skill-fireball"</span>,
    Position: <span class="code-keyword">new</span> Vector3(<span class="code-number">100</span>, <span class="code-number">50</span>, <span class="code-number">200</span>)
);

<span class="code-comment">// 战斗服务处理 (< 1μs)</span>
<span class="code-keyword">var</span> result = <span class="code-keyword">await</span> mediator.SendAsync&lt;
    <span class="code-type">PlayerAttackCommand</span>,
    <span class="code-type">AttackResult</span>
&gt;(command);

<span class="code-comment">// 广播事件到房间内所有玩家</span></code></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Architecture Evolution -->
    <section class="section architecture-evolution">
        <div class="container">
            <h2 class="section-title">🏗️ 架构演进路径</h2>
            <p class="section-subtitle">从单体到分布式，从简单到复杂，循序渐进构建系统</p>

            <div class="evolution-timeline">
                <!-- Stage 1 -->
                <div class="evolution-step">
                    <div class="evolution-marker"></div>
                    <div class="evolution-content">
                        <h3 class="evolution-title">阶段 1: 单体应用 + InMemory</h3>
                        <p class="evolution-subtitle">快速开发，本地调试，适合初期 MVP</p>
                        <div class="evolution-features">
                            <div class="evolution-feature">✅ 快速启动</div>
                            <div class="evolution-feature">✅ 零依赖</div>
                            <div class="evolution-feature">✅ 简单调试</div>
                            <div class="evolution-feature">✅ 单机部署</div>
                        </div>
                    </div>
                </div>

                <!-- Stage 2 -->
                <div class="evolution-step">
                    <div class="evolution-marker"></div>
                    <div class="evolution-content">
                        <h3 class="evolution-title">阶段 2: 单体应用 + Redis</h3>
                        <p class="evolution-subtitle">增加持久化，支持水平扩展</p>
                        <div class="evolution-features">
                            <div class="evolution-feature">✅ 多实例部署</div>
                            <div class="evolution-feature">✅ 消息持久化</div>
                            <div class="evolution-feature">✅ 负载均衡</div>
                            <div class="evolution-feature">✅ 缓存优化</div>
                        </div>
                    </div>
                </div>

                <!-- Stage 3 -->
                <div class="evolution-step">
                    <div class="evolution-marker"></div>
                    <div class="evolution-content">
                        <h3 class="evolution-title">阶段 3: 微服务 + NATS</h3>
                        <p class="evolution-subtitle">服务拆分，低延迟通信</p>
                        <div class="evolution-features">
                            <div class="evolution-feature">✅ 服务独立部署</div>
                            <div class="evolution-feature">✅ 毫秒级延迟</div>
                            <div class="evolution-feature">✅ 服务发现</div>
                            <div class="evolution-feature">✅ 容错处理</div>
                        </div>
                    </div>
                </div>

                <!-- Stage 4 -->
                <div class="evolution-step">
                    <div class="evolution-marker"></div>
                    <div class="evolution-content">
                        <h3 class="evolution-title">阶段 4: 事件溯源 + CQRS</h3>
                        <p class="evolution-subtitle">读写分离，完整审计</p>
                        <div class="evolution-features">
                            <div class="evolution-feature">✅ 事件溯源</div>
                            <div class="evolution-feature">✅ 读写分离</div>
                            <div class="evolution-feature">✅ 审计日志</div>
                            <div class="evolution-feature">✅ 时间旅行</div>
                        </div>
                    </div>
                </div>

                <!-- Stage 5 -->
                <div class="evolution-step">
                    <div class="evolution-marker"></div>
                    <div class="evolution-content">
                        <h3 class="evolution-title">阶段 5: 云原生 + Aspire</h3>
                        <p class="evolution-subtitle">容器化，可观测，生产就绪</p>
                        <div class="evolution-features">
                            <div class="evolution-feature">✅ 容器化部署</div>
                            <div class="evolution-feature">✅ 分布式追踪</div>
                            <div class="evolution-feature">✅ 健康检查</div>
                            <div class="evolution-feature">✅ 自动扩缩容</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Code Examples -->
    <section id="examples" class="section code-examples">
        <div class="container">
            <h2 class="section-title">💻 代码示例</h2>
            <p class="section-subtitle">实用的代码片段，复制粘贴即可使用</p>

            <div class="code-tabs">
                <div class="code-tab active" onclick="switchCodeTab(0)">快速开始</div>
                <div class="code-tab" onclick="switchCodeTab(1)">异常处理</div>
                <div class="code-tab" onclick="switchCodeTab(2)">事件发布</div>
                <div class="code-tab" onclick="switchCodeTab(3)">Redis 配置</div>
                <div class="code-tab" onclick="switchCodeTab(4)">NATS 配置</div>
            </div>

            <!-- Tab 1: Quick Start -->
            <div class="code-panel active">
                <pre><code><span class="code-comment">// 1. 安装 NuGet 包</span>
dotnet add package Catga
dotnet add package Catga.Transport.InMemory
dotnet add package Catga.SourceGenerator

<span class="code-comment">// 2. 配置服务 (Program.cs)</span>
<span class="code-keyword">var</span> builder = <span class="code-type">WebApplication</span>.CreateBuilder(args);

builder.Services
    .AddCatga()
    .AddGeneratedHandlers()      <span class="code-comment">// 自动注册所有 Handler</span>
    .AddInMemoryTransport();     <span class="code-comment">// 使用内存传输</span>

<span class="code-keyword">var</span> app = builder.Build();
app.Run();

<span class="code-comment">// 3. 定义命令</span>
<span class="code-keyword">public record</span> <span class="code-type">CreateUserCommand</span>(
    <span class="code-type">string</span> Name,
    <span class="code-type">string</span> Email
) : <span class="code-type">IRequest</span>&lt;<span class="code-type">User</span>&gt;;

<span class="code-comment">// 4. 实现 Handler (自动注册)</span>
<span class="code-keyword">public class</span> <span class="code-type">CreateUserHandler</span>
    : <span class="code-type">IRequestHandler</span>&lt;<span class="code-type">CreateUserCommand</span>, <span class="code-type">User</span>&gt;
{
    <span class="code-keyword">public async</span> <span class="code-type">Task</span>&lt;<span class="code-type">CatgaResult</span>&lt;<span class="code-type">User</span>&gt;&gt; HandleAsync(
        <span class="code-type">CreateUserCommand</span> request,
        <span class="code-type">CancellationToken</span> cancellationToken)
    {
        <span class="code-keyword">var</span> user = <span class="code-keyword">new</span> <span class="code-type">User</span> { Name = request.Name, Email = request.Email };
        <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">User</span>&gt;.Success(user);
    }
}

<span class="code-comment">// 5. 发送命令</span>
<span class="code-keyword">var</span> result = <span class="code-keyword">await</span> mediator.SendAsync&lt;<span class="code-type">CreateUserCommand</span>, <span class="code-type">User</span>&gt;(
    <span class="code-keyword">new</span> <span class="code-type">CreateUserCommand</span>(<span class="code-string">"Alice"</span>, <span class="code-string">"alice@example.com"</span>)
);

<span class="code-keyword">if</span> (result.IsSuccess)
    Console.WriteLine(<span class="code-string">$"用户已创建: {result.Value.Name}"</span>);</code></pre>
            </div>

            <!-- Tab 2: Error Handling -->
            <div class="code-panel">
                <pre><code><span class="code-comment">// Handler 中的完整异常处理</span>
<span class="code-keyword">public async</span> <span class="code-type">Task</span>&lt;<span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;&gt; HandleAsync(
    <span class="code-type">CreateOrderCommand</span> request,
    <span class="code-type">CancellationToken</span> cancellationToken)
{
    <span class="code-comment">// 1. 参数验证</span>
    <span class="code-keyword">if</span> (<span class="code-keyword">string</span>.IsNullOrEmpty(request.ProductId))
        <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;.Failure(<span class="code-string">"产品ID不能为空"</span>);

    <span class="code-keyword">if</span> (request.Quantity &lt;= <span class="code-number">0</span>)
        <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;.Failure(<span class="code-string">"数量必须大于0"</span>);

    <span class="code-keyword">try</span>
    {
        <span class="code-comment">// 2. 业务逻辑</span>
        <span class="code-keyword">var</span> product = <span class="code-keyword">await</span> _productRepo.GetByIdAsync(
            request.ProductId,
            cancellationToken
        );

        <span class="code-keyword">if</span> (product == <span class="code-keyword">null</span>)
            <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;.Failure(<span class="code-string">$"产品不存在: {request.ProductId}"</span>);

        <span class="code-keyword">if</span> (product.Stock &lt; request.Quantity)
            <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;.Failure(
                <span class="code-string">$"库存不足，剩余: {product.Stock}"</span>
            );

        <span class="code-comment">// 3. 创建订单</span>
        <span class="code-keyword">var</span> order = <span class="code-keyword">new</span> <span class="code-type">Order</span>(request.ProductId, request.Quantity);
        <span class="code-keyword">await</span> _orderRepo.SaveAsync(order, cancellationToken);

        <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;.Success(order);
    }
    <span class="code-keyword">catch</span> (<span class="code-type">DbUpdateException</span> ex)
    {
        _logger.LogError(ex, <span class="code-string">"数据库错误"</span>);
        <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;.Failure(<span class="code-string">$"数据库错误: {ex.Message}"</span>);
    }
    <span class="code-keyword">catch</span> (<span class="code-type">OperationCanceledException</span>)
    {
        <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;.Failure(<span class="code-string">"操作已取消"</span>);
    }
    <span class="code-keyword">catch</span> (<span class="code-type">Exception</span> ex)
    {
        _logger.LogError(ex, <span class="code-string">"未知错误"</span>);
        <span class="code-keyword">return</span> <span class="code-type">CatgaResult</span>&lt;<span class="code-type">Order</span>&gt;.Failure(<span class="code-string">$"未知错误: {ex.Message}"</span>);
    }
}</code></pre>
            </div>

            <!-- Tab 3: Event Publishing -->
            <div class="code-panel">
                <pre><code><span class="code-comment">// 1. 定义事件</span>
<span class="code-keyword">public record</span> <span class="code-type">OrderCreatedEvent</span>(
    <span class="code-type">string</span> OrderId,
    <span class="code-type">string</span> ProductId,
    <span class="code-type">int</span> Quantity,
    <span class="code-type">DateTime</span> CreatedAt
) : <span class="code-type">IEvent</span>;

<span class="code-comment">// 2. 发布事件 (在 Handler 中)</span>
<span class="code-keyword">var</span> order = <span class="code-keyword">new</span> <span class="code-type">Order</span>(request.ProductId, request.Quantity);
<span class="code-keyword">await</span> _orderRepo.SaveAsync(order, cancellationToken);

<span class="code-keyword">var</span> @event = <span class="code-keyword">new</span> <span class="code-type">OrderCreatedEvent</span>(
    order.Id,
    order.ProductId,
    order.Quantity,
    DateTime.UtcNow
);

<span class="code-keyword">await</span> mediator.PublishAsync(@event, cancellationToken);

<span class="code-comment">// 3. 事件 Handler 1: 发送邮件通知 (自动注册)</span>
<span class="code-keyword">public class</span> <span class="code-type">SendEmailHandler</span> : <span class="code-type">IEventHandler</span>&lt;<span class="code-type">OrderCreatedEvent</span>&gt;
{
    <span class="code-keyword">public async</span> <span class="code-type">Task</span> HandleAsync(
        <span class="code-type">OrderCreatedEvent</span> @event,
        <span class="code-type">CancellationToken</span> cancellationToken)
    {
        <span class="code-keyword">await</span> _emailService.SendAsync(
            <span class="code-string">"order-confirmation.html"</span>,
            <span class="code-keyword">new</span> { @event.OrderId, @event.ProductId },
            cancellationToken
        );
    }
}

<span class="code-comment">// 4. 事件 Handler 2: 更新库存 (自动注册)</span>
<span class="code-keyword">public class</span> <span class="code-type">UpdateInventoryHandler</span> : <span class="code-type">IEventHandler</span>&lt;<span class="code-type">OrderCreatedEvent</span>&gt;
{
    <span class="code-keyword">public async</span> <span class="code-type">Task</span> HandleAsync(
        <span class="code-type">OrderCreatedEvent</span> @event,
        <span class="code-type">CancellationToken</span> cancellationToken)
    {
        <span class="code-keyword">await</span> _inventoryService.DecreaseStockAsync(
            @event.ProductId,
            @event.Quantity,
            cancellationToken
        );
    }
}</code></pre>
            </div>

            <!-- Tab 4: Redis Configuration -->
            <div class="code-panel">
                <pre><code><span class="code-comment">// 1. 安装 Redis 包</span>
dotnet add package Catga.Transport.Redis
dotnet add package Catga.Persistence.Redis

<span class="code-comment">// 2. 配置 Redis (Program.cs)</span>
builder.Services.AddCatga().AddGeneratedHandlers();

<span class="code-comment">// Redis 传输层 (QoS 0 Pub/Sub, QoS 1 Streams)</span>
builder.Services.AddRedisTransport(options =>
{
    options.Configuration = <span class="code-string">"localhost:6379"</span>;
    options.DefaultQoS = QoS.AtLeastOnce;  <span class="code-comment">// QoS 1</span>
    options.StreamMaxLength = <span class="code-number">10000</span>;       <span class="code-comment">// Stream 最大长度</span>
    options.ConsumerGroup = <span class="code-string">"my-service"</span>;   <span class="code-comment">// 消费者组</span>
});

<span class="code-comment">// Redis Outbox 持久化</span>
builder.Services.AddRedisOutbox(options =>
{
    options.Configuration = <span class="code-string">"localhost:6379"</span>;
    options.BatchSize = <span class="code-number">100</span>;               <span class="code-comment">// 批量发送 100 条</span>
    options.PollingInterval = TimeSpan.FromSeconds(<span class="code-number">5</span>);
    options.MaxRetries = <span class="code-number">3</span>;                 <span class="code-comment">// 最多重试 3 次</span>
});

<span class="code-comment">// Redis Inbox 幂等性</span>
builder.Services.AddRedisInbox(options =>
{
    options.Configuration = <span class="code-string">"localhost:6379"</span>;
    options.RetentionPeriod = TimeSpan.FromDays(<span class="code-number">7</span>);  <span class="code-comment">// 保留 7 天</span>
});

<span class="code-comment">// 3. appsettings.json 配置</span>
{
  <span class="code-string">"ConnectionStrings"</span>: {
    <span class="code-string">"Redis"</span>: <span class="code-string">"localhost:6379,password=your-password,ssl=false"</span>
  }
}</code></pre>
            </div>

            <!-- Tab 5: NATS Configuration -->
            <div class="code-panel">
                <pre><code><span class="code-comment">// 1. 安装 NATS 包</span>
dotnet add package Catga.Transport.Nats
dotnet add package Catga.Persistence.Nats

<span class="code-comment">// 2. 配置 NATS (Program.cs)</span>
builder.Services.AddCatga().AddGeneratedHandlers();

<span class="code-comment">// NATS 传输层 (Core/JetStream)</span>
builder.Services.AddNatsTransport(options =>
{
    options.Url = <span class="code-string">"nats://localhost:4222"</span>;
    options.UseJetStream = <span class="code-keyword">true</span>;           <span class="code-comment">// 启用 JetStream</span>
    options.StreamName = <span class="code-string">"CATGA_EVENTS"</span>;
    options.MaxRetries = <span class="code-number">3</span>;
    options.ReconnectWait = TimeSpan.FromSeconds(<span class="code-number">2</span>);
});

<span class="code-comment">// NATS KV 事件溯源</span>
builder.Services.AddNatsEventStore(options =>
{
    options.Url = <span class="code-string">"nats://localhost:4222"</span>;
    options.BucketName = <span class="code-string">"catga-events"</span>;
    options.MaxHistoryPerKey = <span class="code-number">100</span>;         <span class="code-comment">// 每个 key 最多 100 个历史</span>
});

<span class="code-comment">// NATS JetStream Outbox</span>
builder.Services.AddNatsOutbox(options =>
{
    options.Url = <span class="code-string">"nats://localhost:4222"</span>;
    options.StreamName = <span class="code-string">"OUTBOX"</span>;
    options.BatchSize = <span class="code-number">50</span>;
    options.PollingInterval = TimeSpan.FromSeconds(<span class="code-number">3</span>);
});

<span class="code-comment">// 3. Docker Compose 启动 NATS</span>
docker run -d --name nats <span class="code-keyword">\</span>
  -p <span class="code-number">4222</span>:<span class="code-number">4222</span> -p <span class="code-number">8222</span>:<span class="code-number">8222</span> <span class="code-keyword">\</span>
  nats:latest -js</code></pre>
            </div>
        </div>
    </section>

    <!-- Comparison Section -->
    <section class="section comparison">
        <div class="container">
            <h2 class="section-title">⚖️ 框架对比</h2>
            <p class="section-subtitle">Catga vs 其他主流框架</p>

            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>特性</th>
                            <th>Catga</th>
                            <th>MediatR</th>
                            <th>MassTransit</th>
                            <th>CAP</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>CQRS 支持</strong></td>
                            <td><span class="check-yes">✓</span></td>
                            <td><span class="check-yes">✓</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-no">-</span></td>
                        </tr>
                        <tr>
                            <td><strong>Event Sourcing</strong></td>
                            <td><span class="check-yes">✓</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-no">-</span></td>
                        </tr>
                        <tr>
                            <td><strong>Native AOT</strong></td>
                            <td><span class="check-yes">✓ 100%</span></td>
                            <td><span class="check-no">✗</span></td>
                            <td><span class="check-no">✗</span></td>
                            <td><span class="check-no">✗</span></td>
                        </tr>
                        <tr>
                            <td><strong>零反射</strong></td>
                            <td><span class="check-yes">✓</span></td>
                            <td><span class="check-no">✗</span></td>
                            <td><span class="check-no">✗</span></td>
                            <td><span class="check-no">✗</span></td>
                        </tr>
                        <tr>
                            <td><strong>Source Generator</strong></td>
                            <td><span class="check-yes">✓</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-no">-</span></td>
                        </tr>
                        <tr>
                            <td><strong>分布式传输</strong></td>
                            <td><span class="check-yes">✓ Redis/NATS</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-yes">✓ 多种</span></td>
                            <td><span class="check-yes">✓ 多种</span></td>
                        </tr>
                        <tr>
                            <td><strong>Outbox/Inbox</strong></td>
                            <td><span class="check-yes">✓ 内置</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-yes">✓</span></td>
                            <td><span class="check-yes">✓</span></td>
                        </tr>
                        <tr>
                            <td><strong>性能 (μs)</strong></td>
                            <td><span class="check-yes">&lt; 1</span></td>
                            <td>~5</td>
                            <td>~10</td>
                            <td>~15</td>
                        </tr>
                        <tr>
                            <td><strong>.NET Aspire</strong></td>
                            <td><span class="check-yes">✓</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-no">-</span></td>
                            <td><span class="check-no">-</span></td>
                        </tr>
                        <tr>
                            <td><strong>OpenTelemetry</strong></td>
                            <td><span class="check-yes">✓ 原生</span></td>
                            <td><span class="check-no">手动</span></td>
                            <td><span class="check-yes">✓</span></td>
                            <td><span class="check-no">手动</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="stats">
        <div class="stats-grid">
            <div class="stat-item">
                <h3>&lt; 1μs</h3>
                <p>命令处理延迟</p>
            </div>
            <div class="stat-item">
                <h3>1M+</h3>
                <p>每秒吞吐量</p>
            </div>
            <div class="stat-item">
                <h3>100%</h3>
                <p>AOT 兼容</p>
            </div>
            <div class="stat-item">
                <h3>194</h3>
                <p>测试覆盖</p>
            </div>
            <div class="stat-item">
                <h3>16</h3>
                <p>NuGet 包</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 Catga Framework. 开源协议: MIT</p>
        <p>
            <a href="https://github.com/Cricle/Catga">GitHub</a> ·
            <a href="https://www.nuget.org/packages/Catga">NuGet</a> ·
            <a href="../articles/getting-started.html">文档</a> ·
            <a href="../api/index.html">API</a>
        </p>
    </footer>

    <script>
        // Toggle learning path step details
        function toggleStep(element) {
            const details = element.querySelector('.step-details');
            const wasActive = element.classList.contains('active');

            // Close all steps
            document.querySelectorAll('.path-step').forEach(step => {
                step.classList.remove('active');
                step.querySelector('.step-details').classList.remove('show');
            });

            // Toggle current step
            if (!wasActive) {
                element.classList.add('active');
                details.classList.add('show');
            }
        }

        // Switch use case tabs
        function switchUseCase(index) {
            // Update tabs
            const tabs = document.querySelectorAll('.use-case-tab');
            tabs.forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });

            // Update content
            const contents = document.querySelectorAll('.use-case-content');
            contents.forEach((content, i) => {
                content.classList.toggle('active', i === index);
            });
        }

        // Switch code tabs
        function switchCodeTab(index) {
            // Update tabs
            const tabs = document.querySelectorAll('.code-tab');
            tabs.forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });

            // Update panels
            const panels = document.querySelectorAll('.code-panel');
            panels.forEach((panel, i) => {
                panel.classList.toggle('active', i === index);
            });
        }

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Toggle mobile menu
        function toggleMobileMenu() {
            const mobileNav = document.getElementById('mobileNav');
            mobileNav.classList.toggle('active');

            // Prevent body scroll when menu is open
            if (mobileNav.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }

        // Theme toggle functionality
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Update particles color for dark mode
            if (typeof pJSDom !== 'undefined' && pJSDom[0]) {
                const particlesColor = newTheme === 'dark' ? '#ffffff' : '#ffffff';
                pJSDom[0].pJS.particles.color.value = particlesColor;
                pJSDom[0].pJS.particles.line_linked.color = particlesColor;
                pJSDom[0].pJS.fn.particlesRefresh();
            }
        }

        // Initialize theme from localStorage
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
            
            if (theme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        })();

        // Number animation for hero stats
        function animateNumber(element) {
            const target = parseFloat(element.dataset.target);
            const duration = 2000;
            const start = 0;
            const startTime = Date.now();

            function update() {
                const currentTime = Date.now();
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                const current = start + (target - start) * easeOutQuart;
                
                // Format number
                if (target >= 1000000) {
                    element.textContent = (current / 1000000).toFixed(1) + 'M';
                } else if (target < 1) {
                    element.textContent = '< 1';
                } else {
                    element.textContent = Math.floor(current);
                }
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            update();
        }

        // Initialize number animations when hero section is visible
        const heroSection = document.querySelector('.hero');
        const heroStats = document.querySelectorAll('.hero-stat-value[data-target]');
        
        const heroObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    heroStats.forEach(stat => animateNumber(stat));
                    heroObserver.unobserve(entry.target);
                }
            });
        }, { threshold: 0.5 });
        
        if (heroSection) {
            heroObserver.observe(heroSection);
        }

        // Initialize particles.js
        if (typeof particlesJS !== 'undefined') {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 80, density: { enable: true, value_area: 800 } },
                    color: { value: '#ffffff' },
                    shape: { type: 'circle' },
                    opacity: {
                        value: 0.5,
                        random: true,
                        anim: { enable: true, speed: 1, opacity_min: 0.1, sync: false }
                    },
                    size: {
                        value: 3,
                        random: true,
                        anim: { enable: true, speed: 2, size_min: 0.1, sync: false }
                    },
                    line_linked: {
                        enable: true,
                        distance: 150,
                        color: '#ffffff',
                        opacity: 0.4,
                        width: 1
                    },
                    move: {
                        enable: true,
                        speed: 2,
                        direction: 'none',
                        random: false,
                        straight: false,
                        out_mode: 'out',
                        bounce: false
                    }
                },
                interactivity: {
                    detect_on: 'canvas',
                    events: {
                        onhover: { enable: true, mode: 'repulse' },
                        onclick: { enable: true, mode: 'push' },
                        resize: true
                    },
                    modes: {
                        repulse: { distance: 100, duration: 0.4 },
                        push: { particles_nb: 4 }
                    }
                },
                retina_detect: true
            });
        }

        // Switch demo tabs
        function switchDemo(index) {
            const tabs = document.querySelectorAll('.demo-tab');
            tabs.forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });

            const contents = document.querySelectorAll('.demo-content');
            contents.forEach((content, i) => {
                content.classList.toggle('active', i === index);
            });
        }

        // Animation utilities
        function addTimelineItem(timelineId, action, type = 'success') {
            const timeline = document.getElementById(timelineId);
            const item = document.createElement('div');
            item.className = `timeline-item ${type}`;
            item.innerHTML = `
                <div class="time">${new Date().toLocaleTimeString()}</div>
                <div class="action">${action}</div>
            `;
            timeline.appendChild(item);
            timeline.scrollTop = timeline.scrollHeight;
        }

        function createNode(canvas, id, text, x, y) {
            const node = document.createElement('div');
            node.className = 'node';
            node.id = id;
            node.style.left = `${x}px`;
            node.style.top = `${y}px`;
            node.innerHTML = `<div>${text}</div>`;
            canvas.appendChild(node);
            return node;
        }

        function activateNode(nodeId) {
            document.getElementById(nodeId)?.classList.add('active');
        }

        function deactivateNode(nodeId) {
            document.getElementById(nodeId)?.classList.remove('active');
        }

        function successNode(nodeId) {
            const node = document.getElementById(nodeId);
            if (node) {
                node.classList.remove('active');
                node.classList.add('success');
            }
        }

        async function animateMessage(canvas, startX, startY, endX, endY, icon = '📨') {
            const message = document.createElement('div');
            message.className = 'message';
            message.textContent = icon;
            message.style.left = `${startX}px`;
            message.style.top = `${startY}px`;
            canvas.appendChild(message);

            await new Promise(resolve => setTimeout(resolve, 50));
            message.classList.add('animating');

            // Calculate movement
            const duration = 2000;
            const steps = 60;
            const stepDuration = duration / steps;
            const deltaX = (endX - startX) / steps;
            const deltaY = (endY - startY) / steps;

            for (let i = 0; i < steps; i++) {
                await new Promise(resolve => setTimeout(resolve, stepDuration));
                message.style.left = `${startX + deltaX * i}px`;
                message.style.top = `${startY + deltaY * i}px`;
            }

            await new Promise(resolve => setTimeout(resolve, 500));
            canvas.removeChild(message);
        }

        // Demo 1: CQRS Flow
        let cqrsRunning = false;

        function resetCQRSDemo() {
            const canvas = document.getElementById('cqrs-canvas');
            const timeline = document.getElementById('cqrs-timeline');
            canvas.innerHTML = '';
            timeline.innerHTML = '';
            cqrsRunning = false;

            // Create nodes
            createNode(canvas, 'cqrs-client', '客户端', 50, 170);
            createNode(canvas, 'cqrs-mediator', 'Mediator', 250, 170);
            createNode(canvas, 'cqrs-handler', 'Handler', 450, 100);
            createNode(canvas, 'cqrs-db', '数据库', 650, 170);
            createNode(canvas, 'cqrs-event', '事件总线', 450, 240);
        }

        async function startCQRSDemo() {
            if (cqrsRunning) return;
            cqrsRunning = true;
            resetCQRSDemo();

            const canvas = document.getElementById('cqrs-canvas');

            // Step 1: Client sends command
            await new Promise(r => setTimeout(r, 500));
            activateNode('cqrs-client');
            addTimelineItem('cqrs-timeline', '客户端发送命令: CreateOrderCommand');

            await animateMessage(canvas, 110, 190, 270, 190, '📝');
            deactivateNode('cqrs-client');

            // Step 2: Mediator routes to handler
            activateNode('cqrs-mediator');
            addTimelineItem('cqrs-timeline', 'Mediator 路由到 Handler');

            await animateMessage(canvas, 310, 180, 470, 130, '➡️');
            deactivateNode('cqrs-mediator');

            // Step 3: Handler processes
            activateNode('cqrs-handler');
            addTimelineItem('cqrs-timeline', 'Handler 处理业务逻辑');
            await new Promise(r => setTimeout(r, 1000));

            // Step 4: Save to database
            await animateMessage(canvas, 510, 120, 670, 180, '💾');
            activateNode('cqrs-db');
            addTimelineItem('cqrs-timeline', '保存数据到数据库');
            await new Promise(r => setTimeout(r, 800));
            successNode('cqrs-db');

            // Step 5: Publish event
            await animateMessage(canvas, 490, 140, 490, 260, '📢');
            deactivateNode('cqrs-handler');
            activateNode('cqrs-event');
            addTimelineItem('cqrs-timeline', '发布事件: OrderCreatedEvent');
            await new Promise(r => setTimeout(r, 800));

            successNode('cqrs-handler');
            successNode('cqrs-event');
            addTimelineItem('cqrs-timeline', '✅ CQRS 流程完成', 'success');

            cqrsRunning = false;
        }

        // Demo 2: Event-Driven
        let eventRunning = false;

        function resetEventDemo() {
            const canvas = document.getElementById('event-canvas');
            const timeline = document.getElementById('event-timeline');
            canvas.innerHTML = '';
            timeline.innerHTML = '';
            eventRunning = false;

            createNode(canvas, 'event-publisher', '发布者', 50, 170);
            createNode(canvas, 'event-bus', '事件总线', 300, 170);
            createNode(canvas, 'event-handler1', 'Handler 1', 550, 50);
            createNode(canvas, 'event-handler2', 'Handler 2', 550, 170);
            createNode(canvas, 'event-handler3', 'Handler 3', 550, 290);
        }

        async function startEventDemo() {
            if (eventRunning) return;
            eventRunning = true;
            resetEventDemo();

            const canvas = document.getElementById('event-canvas');

            // Step 1: Publish event
            await new Promise(r => setTimeout(r, 500));
            activateNode('event-publisher');
            addTimelineItem('event-timeline', '发布事件: OrderCreatedEvent');

            await animateMessage(canvas, 110, 190, 320, 190, '📢');
            deactivateNode('event-publisher');
            successNode('event-publisher');

            // Step 2: Event bus receives
            activateNode('event-bus');
            addTimelineItem('event-timeline', '事件总线接收事件');
            await new Promise(r => setTimeout(r, 500));

            // Step 3: Broadcast to all handlers (parallel)
            addTimelineItem('event-timeline', '广播到所有订阅者');

            const promises = [
                animateMessage(canvas, 360, 180, 570, 70, '📨'),
                animateMessage(canvas, 360, 190, 570, 190, '📨'),
                animateMessage(canvas, 360, 200, 570, 310, '📨')
            ];

            await Promise.all(promises);
            deactivateNode('event-bus');

            // Step 4: Handlers process in parallel
            activateNode('event-handler1');
            activateNode('event-handler2');
            activateNode('event-handler3');

            addTimelineItem('event-timeline', 'Handler 1: 发送邮件通知');
            await new Promise(r => setTimeout(r, 800));
            successNode('event-handler1');

            addTimelineItem('event-timeline', 'Handler 2: 更新库存');
            await new Promise(r => setTimeout(r, 800));
            successNode('event-handler2');

            addTimelineItem('event-timeline', 'Handler 3: 创建发货单');
            await new Promise(r => setTimeout(r, 800));
            successNode('event-handler3');

            addTimelineItem('event-timeline', '✅ 事件处理完成', 'success');

            eventRunning = false;
        }

        // Demo 3: Outbox Pattern
        let outboxRunning = false;

        function resetOutboxDemo() {
            const canvas = document.getElementById('outbox-canvas');
            const timeline = document.getElementById('outbox-timeline');
            canvas.innerHTML = '';
            timeline.innerHTML = '';
            outboxRunning = false;

            createNode(canvas, 'outbox-service', '服务', 50, 100);
            createNode(canvas, 'outbox-db', '数据库', 250, 100);
            createNode(canvas, 'outbox-table', 'Outbox 表', 250, 240);
            createNode(canvas, 'outbox-publisher', 'Publisher', 500, 170);
            createNode(canvas, 'outbox-mq', '消息队列', 700, 170);
        }

        async function startOutboxDemo() {
            if (outboxRunning) return;
            outboxRunning = true;
            resetOutboxDemo();

            const canvas = document.getElementById('outbox-canvas');

            // Step 1: Service handles command
            await new Promise(r => setTimeout(r, 500));
            activateNode('outbox-service');
            addTimelineItem('outbox-timeline', '服务处理命令');
            await new Promise(r => setTimeout(r, 800));

            // Step 2: Save business data (Transaction start)
            addTimelineItem('outbox-timeline', '⚡ 开始数据库事务');
            await animateMessage(canvas, 110, 120, 270, 120, '💾');
            activateNode('outbox-db');
            addTimelineItem('outbox-timeline', '保存业务数据');
            await new Promise(r => setTimeout(r, 800));

            // Step 3: Save to outbox (Same transaction)
            await animateMessage(canvas, 290, 140, 290, 260, '📝');
            activateNode('outbox-table');
            addTimelineItem('outbox-timeline', '写入 Outbox 表（同一事务）');
            await new Promise(r => setTimeout(r, 800));

            // Step 4: Commit transaction
            successNode('outbox-db');
            successNode('outbox-table');
            addTimelineItem('outbox-timeline', '✅ 提交事务（原子操作）', 'success');
            deactivateNode('outbox-service');
            successNode('outbox-service');
            await new Promise(r => setTimeout(r, 1000));

            // Step 5: Outbox publisher reads
            activateNode('outbox-publisher');
            addTimelineItem('outbox-timeline', 'Outbox Publisher 轮询');
            await animateMessage(canvas, 310, 260, 520, 190, '🔍');
            await new Promise(r => setTimeout(r, 800));

            // Step 6: Publish to message queue
            addTimelineItem('outbox-timeline', '发布消息到队列');
            await animateMessage(canvas, 560, 190, 720, 190, '📨');
            deactivateNode('outbox-publisher');
            successNode('outbox-publisher');
            activateNode('outbox-mq');
            await new Promise(r => setTimeout(r, 800));

            successNode('outbox-mq');
            addTimelineItem('outbox-timeline', '✅ 消息可靠发送（确保一致性）', 'success');

            outboxRunning = false;
        }

        // Demo 4: Distributed Tracing
        let tracingRunning = false;

        function resetTracingDemo() {
            const canvas = document.getElementById('tracing-canvas');
            const timeline = document.getElementById('tracing-timeline');
            canvas.innerHTML = '';
            timeline.innerHTML = '';
            tracingRunning = false;

            createNode(canvas, 'trace-api', 'API Gateway', 50, 170);
            createNode(canvas, 'trace-order', '订单服务', 250, 100);
            createNode(canvas, 'trace-payment', '支付服务', 450, 100);
            createNode(canvas, 'trace-inventory', '库存服务', 250, 240);
            createNode(canvas, 'trace-notify', '通知服务', 450, 240);
            createNode(canvas, 'trace-otel', 'OpenTelemetry', 650, 170);
        }

        async function startTracingDemo() {
            if (tracingRunning) return;
            tracingRunning = true;
            resetTracingDemo();

            const canvas = document.getElementById('tracing-canvas');

            // Step 1: API receives request
            await new Promise(r => setTimeout(r, 500));
            activateNode('trace-api');
            addTimelineItem('tracing-timeline', '🔗 创建 Trace: trace-id-123');
            addTimelineItem('tracing-timeline', 'API Gateway 接收请求');
            await new Promise(r => setTimeout(r, 800));

            // Step 2: Call order service
            await animateMessage(canvas, 110, 180, 270, 120, '📞');
            activateNode('trace-order');
            addTimelineItem('tracing-timeline', 'Span 1: 调用订单服务（传递 TraceContext）');
            await new Promise(r => setTimeout(r, 1000));

            // Step 3: Order calls payment
            await animateMessage(canvas, 310, 110, 470, 110, '💳');
            activateNode('trace-payment');
            addTimelineItem('tracing-timeline', 'Span 1.1: 调用支付服务');
            await new Promise(r => setTimeout(r, 1000));
            successNode('trace-payment');
            deactivateNode('trace-payment');

            // Step 4: Order calls inventory
            await animateMessage(canvas, 290, 140, 290, 260, '📦');
            activateNode('trace-inventory');
            addTimelineItem('tracing-timeline', 'Span 1.2: 调用库存服务');
            await new Promise(r => setTimeout(r, 1000));
            successNode('trace-inventory');
            deactivateNode('trace-inventory');

            // Step 5: Order complete
            successNode('trace-order');
            deactivateNode('trace-order');

            // Step 6: Call notification service
            await animateMessage(canvas, 90, 200, 470, 260, '📧');
            activateNode('trace-notify');
            addTimelineItem('tracing-timeline', 'Span 2: 调用通知服务');
            await new Promise(r => setTimeout(r, 1000));
            successNode('trace-notify');
            deactivateNode('trace-notify');

            successNode('trace-api');
            deactivateNode('trace-api');

            // Step 7: Send to OpenTelemetry
            addTimelineItem('tracing-timeline', '📊 发送追踪数据到 OpenTelemetry');
            activateNode('trace-otel');
            await new Promise(r => setTimeout(r, 800));
            successNode('trace-otel');

            addTimelineItem('tracing-timeline', '✅ 分布式追踪完成（全链路可视化）', 'success');

            tracingRunning = false;
        }

        // Initialize first demo on page load
        window.addEventListener('load', () => {
            resetCQRSDemo();
            resetEventDemo();
            resetOutboxDemo();
            resetTracingDemo();
        });
    </script>

    <!-- Back to Top Button -->
    <button id="backToTop" class="back-to-top" onclick="scrollToTop()" title="返回顶部">
        <span class="back-to-top-icon">↑</span>
    </button>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">⚡</div>
            <div class="loading-text">Catga</div>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- Particles.js -->
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

    <script>
        // Back to top functionality
        const backToTopBtn = document.getElementById('backToTop');
        
        window.addEventListener('scroll', () => {
            if (window.scrollY > 500) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        });

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Loading screen
        window.addEventListener('load', () => {
            const loadingScreen = document.getElementById('loadingScreen');
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
            }, 800);
        });
    </script>
</body>
</html>
