import{k as I,r as q,q as p,C as t,c as S,u as l,w as a,L as o,a4 as m,ac as w,v as c,F as b,D as z,x as r,o as i}from"./vue-u7mJywCV.js";import{u as B}from"./index-DudhKhkr.js";import{u as F}from"./order-RrLd4p2a.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vuestic-BDyIGwgF.js";const $={class:"cart-table"},D={class:"qty"},E={class:"price"},V={class:"summary"},L={class:"total"},O=I({__name:"Cart",setup(Q){const v=w(),s=B(),g=F(),_=q(!1),x=async()=>{if(!s.isEmpty){_.value=!0;try{await g.createOrder({customerId:"CUST-"+Date.now().toString(36),items:s.items.map(u=>({productId:u.productId,productName:u.name,quantity:u.quantity,unitPrice:u.price}))}),s.clear(),v.push("/orders")}finally{_.value=!1}}};return(u,e)=>{const k=m("va-icon"),d=m("va-button"),f=m("va-card-content"),y=m("va-card");return i(),p("div",null,[e[8]||(e[8]=t("h2",{class:"mb-4"},"购物车",-1)),l(s).isEmpty?(i(),S(y,{key:0},{default:a(()=>[o(f,{class:"text-center pa-6"},{default:a(()=>[o(k,{name:"shopping_cart",size:"3rem",color:"secondary"}),e[2]||(e[2]=t("p",{class:"mt-3"},"购物车是空的",-1)),o(d,{class:"mt-3",onClick:e[0]||(e[0]=n=>l(v).push("/"))},{default:a(()=>[...e[1]||(e[1]=[c("去购物",-1)])]),_:1})]),_:1})]),_:1})):(i(),p(b,{key:1},[o(y,{class:"mb-4"},{default:a(()=>[o(f,null,{default:a(()=>[t("table",$,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",null,"商品"),t("th",null,"单价"),t("th",null,"数量"),t("th",null,"小计"),t("th")])],-1)),t("tbody",null,[(i(!0),p(b,null,z(l(s).items,n=>(i(),p("tr",{key:n.productId},[t("td",null,r(n.name),1),t("td",null,"¥"+r(n.price),1),t("td",null,[o(d,{size:"small",preset:"secondary",onClick:C=>l(s).updateQuantity(n.productId,n.quantity-1)},{default:a(()=>[...e[3]||(e[3]=[c("-",-1)])]),_:1},8,["onClick"]),t("span",D,r(n.quantity),1),o(d,{size:"small",preset:"secondary",onClick:C=>l(s).updateQuantity(n.productId,n.quantity+1)},{default:a(()=>[...e[4]||(e[4]=[c("+",-1)])]),_:1},8,["onClick"])]),t("td",E,"¥"+r((n.price*n.quantity).toFixed(2)),1),t("td",null,[o(d,{size:"small",color:"danger",preset:"plain",onClick:C=>l(s).removeItem(n.productId)},{default:a(()=>[o(k,{name:"delete"})]),_:1},8,["onClick"])])]))),128))])])]),_:1})]),_:1}),o(y,null,{default:a(()=>[o(f,null,{default:a(()=>[t("div",V,[t("span",null,"共 "+r(l(s).count)+" 件商品",1),t("span",L,[e[6]||(e[6]=c("合计: ",-1)),t("strong",null,"¥"+r(l(s).total.toFixed(2)),1)])]),o(d,{color:"primary",block:"",loading:_.value,onClick:x},{default:a(()=>[...e[7]||(e[7]=[c("提交订单",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})],64))])}}}),j=N(O,[["__scopeId","data-v-8788804d"]]);export{j as default};
