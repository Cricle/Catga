import{k as R,r as x,q as b,L as e,c as C,w as a,a4 as o,v as n,C as l,x as i,u,ad as U,F as O,D as V,o as c}from"./vue-DxbRKzch.js";import{u as M}from"./index-CKOG3alp.js";import{u as P}from"./order-Cp0QkwRJ.js";import"./vuestic-BlKE5WT7.js";import"./index-Ca5JJS8k.js";import"./index-B9ygI19o.js";const T={class:"text-secondary mb-4"},A={key:2,class:"row"},G={class:"flex md8 xs12"},H={class:"va-text-danger"},J={class:"flex md4 xs12"},K={class:"d-flex justify-space-between mb-2"},Q={class:"d-flex justify-space-between mb-4"},W={class:"va-text-danger va-h5"},st=R({__name:"Checkout",setup(X){const v=U(),d=M(),q=P(),k=x(!1),w=x("alipay"),S=x(!1),F=x(""),B=[{value:"alipay",text:"支付宝"},{value:"wechat",text:"微信支付"},{value:"card",text:"银行卡"}],E=async()=>{if(!d.isEmpty){k.value=!0;try{const f=await q.createOrder({customerId:"USER-"+Date.now().toString(36),items:d.items.map(t=>({productId:t.productId,productName:t.name,quantity:t.quantity,unitPrice:t.price}))});F.value=f.orderId,S.value=!0,d.clear()}catch(f){console.error("Order failed:",f)}finally{k.value=!1}}};return(f,t)=>{const r=o("va-icon"),y=o("va-card-title"),m=o("va-card"),p=o("va-button"),_=o("va-card-content"),N=o("va-avatar"),g=o("va-list-item-section"),I=o("va-list-item-label"),$=o("va-list-item"),j=o("va-list"),D=o("va-radio"),z=o("va-divider");return c(),b("div",null,[e(m,{class:"mb-4"},{default:a(()=>[e(y,null,{default:a(()=>[e(r,{name:"payment",class:"mr-2"}),t[5]||(t[5]=n("结算 ",-1))]),_:1})]),_:1}),S.value?(c(),C(m,{key:0,class:"text-center"},{default:a(()=>[e(_,{class:"pa-6"},{default:a(()=>[e(r,{name:"check_circle",size:"4rem",color:"success"}),t[8]||(t[8]=l("h2",{class:"va-h4 mt-4"},"订单提交成功！",-1)),l("p",T,"订单号: "+i(F.value),1),e(p,{color:"primary",class:"mr-2",onClick:t[0]||(t[0]=s=>u(v).push("/my-orders"))},{default:a(()=>[e(r,{name:"receipt_long",class:"mr-2"}),t[6]||(t[6]=n("查看订单 ",-1))]),_:1}),e(p,{preset:"secondary",onClick:t[1]||(t[1]=s=>u(v).push("/"))},{default:a(()=>[e(r,{name:"store",class:"mr-2"}),t[7]||(t[7]=n("继续购物 ",-1))]),_:1})]),_:1})]),_:1})):u(d).isEmpty?(c(),C(m,{key:1,class:"text-center"},{default:a(()=>[e(_,{class:"pa-6"},{default:a(()=>[e(r,{name:"remove_shopping_cart",size:"4rem",color:"secondary"}),t[10]||(t[10]=l("h3",{class:"va-h5 mt-4"},"购物车是空的",-1)),e(p,{class:"mt-4",onClick:t[2]||(t[2]=s=>u(v).push("/"))},{default:a(()=>[e(r,{name:"store",class:"mr-2"}),t[9]||(t[9]=n("去购物 ",-1))]),_:1})]),_:1})]),_:1})):(c(),b("div",A,[l("div",G,[e(m,{class:"mb-4"},{default:a(()=>[e(y,null,{default:a(()=>[n("订单商品 ("+i(u(d).count)+" 件)",1)]),_:1}),e(_,null,{default:a(()=>[e(j,null,{default:a(()=>[(c(!0),b(O,null,V(u(d).items,s=>(c(),C($,{key:s.productId},{default:a(()=>[e(g,{avatar:""},{default:a(()=>[e(N,{color:"background-element"},{default:a(()=>[e(r,{name:s.image,color:"primary"},null,8,["name"])]),_:2},1024)]),_:2},1024),e(g,null,{default:a(()=>[e(I,null,{default:a(()=>[n(i(s.name),1)]),_:2},1024),e(I,{caption:""},{default:a(()=>[n("¥"+i(s.price.toFixed(2))+" × "+i(s.quantity),1)]),_:2},1024)]),_:2},1024),e(g,{side:""},{default:a(()=>[l("strong",H,"¥"+i((s.price*s.quantity).toFixed(2)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(m,{class:"mb-4"},{default:a(()=>[e(y,null,{default:a(()=>[...t[11]||(t[11]=[n("支付方式",-1)])]),_:1}),e(_,null,{default:a(()=>[(c(),b(O,null,V(B,s=>e(D,{key:s.value,modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=L=>w.value=L),option:s.value,label:s.text,class:"mb-2"},null,8,["modelValue","option","label"])),64))]),_:1})]),_:1})]),l("div",J,[e(m,null,{default:a(()=>[e(y,null,{default:a(()=>[...t[12]||(t[12]=[n("订单摘要",-1)])]),_:1}),e(_,null,{default:a(()=>[l("div",K,[t[13]||(t[13]=l("span",null,"商品金额",-1)),l("span",null,"¥"+i(u(d).total.toFixed(2)),1)]),t[17]||(t[17]=l("div",{class:"d-flex justify-space-between mb-2"},[l("span",null,"运费"),l("span",{class:"va-text-success"},"免运费")],-1)),e(z,{class:"my-3"}),l("div",Q,[t[14]||(t[14]=l("strong",null,"应付金额",-1)),l("strong",W,"¥"+i(u(d).total.toFixed(2)),1)]),e(p,{color:"primary",block:"",loading:k.value,onClick:E},{default:a(()=>[e(r,{name:"check",class:"mr-2"}),t[15]||(t[15]=n("提交订单 ",-1))]),_:1},8,["loading"]),e(p,{preset:"secondary",block:"",class:"mt-2",onClick:t[4]||(t[4]=s=>u(v).push("/cart"))},{default:a(()=>[e(r,{name:"arrow_back",class:"mr-2"}),t[16]||(t[16]=n("返回购物车 ",-1))]),_:1})]),_:1})]),_:1})])]))])}}});export{st as default};
