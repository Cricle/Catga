import{a as P}from"./index-qEU9UwJ9.js";import{k as L,r as _,q as u,L as l,w as n,a4 as d,v as g,C as s,n as m,t as y,x as p,F as T,D as z,o as c}from"./vue-b2tVlrm7.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"flow-page"},R={class:"flow-diagram"},B={class:"demo-section"},V={class:"demo-controls"},W={key:0,class:"result-section"},A={key:0},q={key:1},M={key:1,class:"logs-section"},$={class:"logs"},j={class:"features-grid"},G={class:"feature"},H={class:"feature"},J={class:"feature"},K={class:"feature"},Q=L({__name:"Flow",setup(U){const k=_(!1),t=_(-1),a=_(null),v=_([]);function r(i,e,f){v.value.push({type:i,icon:e,message:f,time:new Date().toLocaleTimeString()})}async function D(){k.value=!0,a.value=null,v.value=[],t.value=-1;try{r("info","play_arrow","Starting Flow execution..."),t.value=0,r("info","save","Step 1: Saving order..."),await new Promise(e=>setTimeout(e,500)),r("success","check","Order saved successfully"),t.value=1,r("info","inventory","Step 2: Reserving stock..."),await new Promise(e=>setTimeout(e,500)),r("success","check","Stock reserved"),t.value=2,r("info","check_circle","Step 3: Confirming order..."),await new Promise(e=>setTimeout(e,500)),r("success","check","Order confirmed"),t.value=3,r("info","notifications","Step 4: Publishing event...");const i=await P.createOrderWithFlow("FLOW-DEMO",[{productId:"FLOW-001",productName:"Flow Demo Product",quantity:1,unitPrice:99.99}]);r("success","check","Event published"),r("success","done_all",`Flow completed! Order: ${i.orderId}`),t.value=4,a.value={success:!0,orderId:i.orderId}}catch(i){r("error","error",`Flow failed: ${i.message}`),a.value={success:!1,error:i.message}}finally{k.value=!1}}function I(){t.value=-1,a.value=null,v.value=[]}return(i,e)=>{const f=d("va-card-title"),o=d("va-icon"),F=d("va-alert"),O=d("va-divider"),S=d("va-button"),C=d("va-card-content"),x=d("va-card");return c(),u("div",N,[l(x,null,{default:n(()=>[l(f,null,{default:n(()=>[...e[0]||(e[0]=[g("Flow / Saga Pattern Demo",-1)])]),_:1}),l(C,null,{default:n(()=>[l(F,{color:"info",class:"mb-4"},{icon:n(()=>[l(o,{name:"info"})]),default:n(()=>[e[1]||(e[1]=s("strong",null,"What is Flow/Saga?",-1)),e[2]||(e[2]=s("p",null,"Flow pattern implements distributed transactions with automatic compensation. If any step fails, previous steps are rolled back automatically.",-1))]),_:1}),s("div",R,[s("div",{class:m(["flow-step",{active:t.value>=0,success:t.value>0}])},[l(o,{name:"save",size:"large"}),e[3]||(e[3]=s("span",null,"Save Order",-1)),e[4]||(e[4]=s("small",null,"Compensation: Delete",-1))],2),l(o,{name:"arrow_forward",class:"arrow"}),s("div",{class:m(["flow-step",{active:t.value>=1,success:t.value>1}])},[l(o,{name:"inventory",size:"large"}),e[5]||(e[5]=s("span",null,"Reserve Stock",-1)),e[6]||(e[6]=s("small",null,"Compensation: Release",-1))],2),l(o,{name:"arrow_forward",class:"arrow"}),s("div",{class:m(["flow-step",{active:t.value>=2,success:t.value>2}])},[l(o,{name:"check_circle",size:"large"}),e[7]||(e[7]=s("span",null,"Confirm Order",-1)),e[8]||(e[8]=s("small",null,"Compensation: Mark Failed",-1))],2),l(o,{name:"arrow_forward",class:"arrow"}),s("div",{class:m(["flow-step",{active:t.value>=3,success:t.value>3}])},[l(o,{name:"notifications",size:"large"}),e[9]||(e[9]=s("span",null,"Publish Event",-1)),e[10]||(e[10]=s("small",null,"No compensation needed",-1))],2)]),l(O),s("div",B,[e[14]||(e[14]=s("h4",null,"Try It Out",-1)),s("div",V,[l(S,{color:"primary",loading:k.value,onClick:D},{default:n(()=>[l(o,{name:"play_arrow",class:"mr-2"}),e[11]||(e[11]=g(" Execute Flow ",-1))]),_:1},8,["loading"]),l(S,{color:"secondary",onClick:I},{default:n(()=>[l(o,{name:"refresh",class:"mr-2"}),e[12]||(e[12]=g(" Reset ",-1))]),_:1})]),a.value?(c(),u("div",W,[l(F,{color:a.value.success?"success":"danger"},{icon:n(()=>[l(o,{name:a.value.success?"check_circle":"error"},null,8,["name"])]),default:n(()=>[s("strong",null,p(a.value.success?"Flow Completed!":"Flow Failed"),1),a.value.orderId?(c(),u("p",A,"Order ID: "+p(a.value.orderId),1)):y("",!0),a.value.error?(c(),u("p",q,p(a.value.error),1)):y("",!0)]),_:1},8,["color"])])):y("",!0),v.value.length?(c(),u("div",M,[e[13]||(e[13]=s("h4",null,"Execution Logs",-1)),s("div",$,[(c(!0),u(T,null,z(v.value,(w,b)=>(c(),u("div",{key:b,class:m(["log-entry",w.type])},[l(o,{name:w.icon,size:"small"},null,8,["name"]),s("span",null,p(w.message),1),s("small",null,p(w.time),1)],2))),128))])])):y("",!0)])]),_:1})]),_:1}),l(x,{class:"mt-4"},{default:n(()=>[l(f,null,{default:n(()=>[...e[15]||(e[15]=[g("Catga Flow DSL Features",-1)])]),_:1}),l(C,null,{default:n(()=>[s("div",j,[s("div",G,[l(o,{name:"account_tree",color:"primary"}),e[16]||(e[16]=s("h5",null,"Declarative Syntax",-1)),e[17]||(e[17]=s("p",null,"Define flows with fluent builder API",-1))]),s("div",H,[l(o,{name:"undo",color:"warning"}),e[18]||(e[18]=s("h5",null,"Auto Compensation",-1)),e[19]||(e[19]=s("p",null,"Automatic rollback on failure",-1))]),s("div",J,[l(o,{name:"timeline",color:"success"}),e[20]||(e[20]=s("h5",null,"State Tracking",-1)),e[21]||(e[21]=s("p",null,"Track flow state through execution",-1))]),s("div",K,[l(o,{name:"replay",color:"secondary"}),e[22]||(e[22]=s("h5",null,"Retry & Recovery",-1)),e[23]||(e[23]=s("p",null,"Built-in retry and recovery",-1))])])]),_:1})]),_:1})])}}}),h=E(Q,[["__scopeId","data-v-65dec0c8"]]);export{h as default};
