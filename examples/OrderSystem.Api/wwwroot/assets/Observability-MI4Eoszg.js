import{a as D}from"./index-DzZRbFal.js";import{k as B,r as p,G as I,q as n,C as e,L as o,v as r,a4 as i,w as s,c as w,F as m,D as v,t as M,x as c,o as a,n as L}from"./vue-C5tvXR9f.js";import{_ as U}from"./_plugin-vue_export-helper-BREQrZf2.js";const H={class:"observability-page"},j={class:"page-header"},q={class:"section-grid"},J={key:0,class:"metrics-list"},R={class:"metric-group"},A={class:"metric-group"},K={class:"metric-group"},P={key:0,class:"tags-list"},Q={class:"tag-group"},W={class:"tag-group"},X={class:"tag-group"},Y={class:"demo-form"},Z={class:"demo-actions"},$={key:0,class:"events-timeline"},h={class:"event-content"},ll=B({__name:"Observability",setup(el){const u=p(null),O=p(!1),F=p(null),b=p("OrderFlow"),k=p(150),T=p("Connection timeout"),S=async()=>{O.value=!0;try{u.value=await D.getObservabilityMetrics()}catch(_){console.error("Failed to load metrics info:",_)}finally{O.value=!1}},E=async()=>{try{F.value=await D.recordFlowDemo(b.value,k.value)}catch(_){console.error("Failed to record flow:",_)}},N=async()=>{try{F.value=await D.recordFailureDemo(b.value,T.value)}catch(_){console.error("Failed to record failure:",_)}};return I(S),(_,l)=>{const d=i("va-icon"),g=i("va-card-title"),V=i("va-chip"),z=i("va-progress-bar"),f=i("va-card-content"),y=i("va-card"),C=i("va-input"),x=i("va-button"),G=i("va-alert");return a(),n("div",H,[e("div",j,[e("h1",null,[o(d,{name:"monitoring",color:"primary",size:"large"}),l[3]||(l[3]=r(" 可观测性 (Observability) ",-1))]),l[4]||(l[4]=e("p",{class:"page-desc"},"Flow DSL 的指标、追踪和日志集成演示",-1))]),e("div",q,[o(y,null,{default:s(()=>[o(g,null,{default:s(()=>[o(d,{name:"analytics",class:"section-icon"}),l[5]||(l[5]=r(" 可用指标 (Metrics) ",-1))]),_:1}),o(f,null,{default:s(()=>[u.value?.FlowMetrics?(a(),n("div",J,[e("div",R,[l[6]||(l[6]=e("h4",null,"计数器 (Counters)",-1)),(a(!0),n(m,null,v(u.value.FlowMetrics.Counters,t=>(a(),w(V,{key:t,size:"small",color:"primary",outline:""},{default:s(()=>[r(c(t),1)]),_:2},1024))),128))]),e("div",A,[l[7]||(l[7]=e("h4",null,"直方图 (Histograms)",-1)),(a(!0),n(m,null,v(u.value.FlowMetrics.Histograms,t=>(a(),w(V,{key:t,size:"small",color:"success",outline:""},{default:s(()=>[r(c(t),1)]),_:2},1024))),128))]),e("div",K,[l[8]||(l[8]=e("h4",null,"仪表 (Gauges)",-1)),(a(!0),n(m,null,v(u.value.FlowMetrics.Gauges,t=>(a(),w(V,{key:t,size:"small",color:"warning",outline:""},{default:s(()=>[r(c(t),1)]),_:2},1024))),128))])])):(a(),w(z,{key:1,indeterminate:""}))]),_:1})]),_:1}),o(y,null,{default:s(()=>[o(g,null,{default:s(()=>[o(d,{name:"account_tree",class:"section-icon"}),l[9]||(l[9]=r(" 追踪标签 (Tracing Tags) ",-1))]),_:1}),o(f,null,{default:s(()=>[u.value?.TracingTags?(a(),n("div",P,[e("div",Q,[l[10]||(l[10]=e("h4",null,"Flow 标签",-1)),(a(!0),n(m,null,v(u.value.TracingTags.FlowTags,t=>(a(),n("code",{key:t,class:"tag-code"},c(t),1))),128))]),e("div",W,[l[11]||(l[11]=e("h4",null,"Step 标签",-1)),(a(!0),n(m,null,v(u.value.TracingTags.StepTags,t=>(a(),n("code",{key:t,class:"tag-code"},c(t),1))),128))]),e("div",X,[l[12]||(l[12]=e("h4",null,"错误标签",-1)),(a(!0),n(m,null,v(u.value.TracingTags.ErrorTags,t=>(a(),n("code",{key:t,class:"tag-code error"},c(t),1))),128))])])):M("",!0)]),_:1})]),_:1})]),o(y,{class:"demo-card"},{default:s(()=>[o(g,null,{default:s(()=>[o(d,{name:"science",class:"section-icon"}),l[13]||(l[13]=r(" 实时演示 - 记录 Flow 指标 ",-1))]),_:1}),o(f,null,{default:s(()=>[e("div",Y,[o(C,{modelValue:b.value,"onUpdate:modelValue":l[0]||(l[0]=t=>b.value=t),label:"Flow 名称",placeholder:"OrderFlow"},null,8,["modelValue"]),o(C,{modelValue:k.value,"onUpdate:modelValue":l[1]||(l[1]=t=>k.value=t),modelModifiers:{number:!0},label:"执行时长 (ms)",type:"number"},null,8,["modelValue"]),o(C,{modelValue:T.value,"onUpdate:modelValue":l[2]||(l[2]=t=>T.value=t),label:"错误信息 (用于失败演示)"},null,8,["modelValue"])]),e("div",Z,[o(x,{color:"success",onClick:E},{default:s(()=>[o(d,{name:"check_circle",class:"btn-icon"}),l[14]||(l[14]=r(" 记录成功的 Flow ",-1))]),_:1}),o(x,{color:"danger",onClick:N},{default:s(()=>[o(d,{name:"error",class:"btn-icon"}),l[15]||(l[15]=r(" 记录失败的 Flow ",-1))]),_:1})]),F.value?(a(),w(G,{key:0,color:"info",class:"demo-result"},{default:s(()=>[e("pre",null,c(JSON.stringify(F.value,null,2)),1)]),_:1})):M("",!0)]),_:1})]),_:1}),o(y,null,{default:s(()=>[o(g,null,{default:s(()=>[o(d,{name:"timeline",class:"section-icon"}),l[16]||(l[16]=r(" 追踪事件 (Tracing Events) ",-1))]),_:1}),o(f,null,{default:s(()=>[u.value?.TracingEvents?(a(),n("div",$,[(a(!0),n(m,null,v(u.value.TracingEvents,(t,ol)=>(a(),n("div",{key:t,class:"event-item"},[e("div",{class:L(["event-dot",{error:t.includes("failed")}])},null,2),e("div",h,[e("code",null,c(t),1)])]))),128))])):M("",!0)]),_:1})]),_:1}),o(y,null,{default:s(()=>[o(g,null,{default:s(()=>[o(d,{name:"dashboard",class:"section-icon"}),l[17]||(l[17]=r(" Grafana 仪表盘 ",-1))]),_:1}),o(f,null,{default:s(()=>[...l[18]||(l[18]=[e("div",{class:"grafana-info"},[e("p",null,[e("strong",null,"仪表盘位置:"),r(),e("code",null,"src/Catga/Observability/GrafanaDashboard.json")]),e("div",{class:"grafana-panels"},[e("h4",null,"包含面板:"),e("ul",null,[e("li",null,"Flow 执行概览"),e("li",null,"活跃 Flow 数量"),e("li",null,"成功率统计"),e("li",null,"执行时长分布"),e("li",null,"Step 分析"),e("li",null,"Top Flows"),e("li",null,"最慢 Steps")])])],-1)])]),_:1})]),_:1})])}}}),nl=U(ll,[["__scopeId","data-v-91923edd"]]);export{nl as default};
