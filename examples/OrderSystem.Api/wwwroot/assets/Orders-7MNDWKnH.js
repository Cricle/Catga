import{u as F}from"./order-RrLd4p2a.js";import{k as V,r as b,G as $,q as m,C as e,c as v,t as x,L as l,w as a,a4 as d,v as u,F as I,D as O,o,x as r}from"./vue-u7mJywCV.js";import{_ as h}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"header"},D={class:"order-header"},A={class:"items"},L={class:"order-footer"},M={class:"total"},S={class:"actions"},T=V({__name:"Orders",setup(E){const f=F(),y=b([]),i=b(!1),k={0:{text:"待支付",color:"warning"},1:{text:"已支付",color:"info"},2:{text:"处理中",color:"primary"},3:{text:"已发货",color:"secondary"},4:{text:"已完成",color:"success"},5:{text:"已取消",color:"danger"}},p=async()=>{i.value=!0;try{y.value=await f.fetchOrders()}finally{i.value=!1}},N=async c=>{await f.payOrder(c,"Alipay","TX-"+Date.now()),await p()},z=async c=>{await f.cancelOrder(c,"用户取消"),await p()};return $(p),(c,t)=>{const C=d("va-icon"),_=d("va-button"),g=d("va-card-content"),w=d("va-card"),B=d("va-chip");return o(),m("div",null,[e("div",q,[t[1]||(t[1]=e("h2",null,"我的订单",-1)),l(_,{preset:"secondary",onClick:p,loading:i.value},{default:a(()=>[l(C,{name:"refresh"})]),_:1},8,["loading"])]),y.value.length===0&&!i.value?(o(),v(w,{key:0},{default:a(()=>[l(g,{class:"text-center pa-6"},{default:a(()=>[l(C,{name:"inbox",size:"3rem",color:"secondary"}),t[3]||(t[3]=e("p",{class:"mt-3"},"暂无订单",-1)),l(_,{class:"mt-3",onClick:t[0]||(t[0]=s=>c.$router.push("/"))},{default:a(()=>[...t[2]||(t[2]=[u("去购物",-1)])]),_:1})]),_:1})]),_:1})):x("",!0),(o(!0),m(I,null,O(y.value,s=>(o(),v(w,{key:s.orderId,class:"mb-3"},{default:a(()=>[l(g,null,{default:a(()=>[e("div",D,[e("span",null,[t[4]||(t[4]=u("订单号: ",-1)),e("code",null,r(s.orderId),1)]),l(B,{color:k[s.status]?.color,size:"small"},{default:a(()=>[u(r(k[s.status]?.text),1)]),_:2},1032,["color"])]),e("div",A,[(o(!0),m(I,null,O(s.items,n=>(o(),m("div",{key:n.productId,class:"item"},[e("span",null,r(n.productName),1),e("span",null,"×"+r(n.quantity),1),e("span",null,"¥"+r(((n.unitPrice||0)*(n.quantity||0)).toFixed(2)),1)]))),128))]),e("div",L,[e("span",M,"合计: ¥"+r(s.totalAmount?.toFixed(2)),1),e("div",S,[s.status===0?(o(),v(_,{key:0,size:"small",color:"success",onClick:n=>N(s.orderId)},{default:a(()=>[...t[5]||(t[5]=[u("支付",-1)])]),_:1},8,["onClick"])):x("",!0),s.status<3?(o(),v(_,{key:1,size:"small",color:"danger",preset:"secondary",onClick:n=>z(s.orderId)},{default:a(()=>[...t[6]||(t[6]=[u("取消",-1)])]),_:1},8,["onClick"])):x("",!0)])])]),_:2},1024)]),_:2},1024))),128))])}}}),j=h(T,[["__scopeId","data-v-abaa55b0"]]);export{j as default};
