import{k as N,r as v,a as g,q as u,C as a,L as o,w as r,v as _,a4 as p,x as i,F as h,D as C,ac as O,o as l,c as V}from"./vue-C5tvXR9f.js";import{u as A}from"./order-DzfrjeFA.js";import{_ as P}from"./_plugin-vue_export-helper-BREQrZf2.js";const R={class:"shop-page"},D={class:"shop-header"},L={class:"product-grid"},H={class:"product-image"},G={class:"product-name"},U={class:"product-desc"},K={class:"product-footer"},M={class:"product-price"},Q={key:0,class:"empty-cart"},W={key:1,class:"cart-items"},Y={class:"cart-item-info"},j={class:"cart-item-name"},J={class:"cart-item-price"},X={class:"cart-item-actions"},Z={class:"cart-item-quantity"},ee={class:"cart-item-subtotal"},te={class:"cart-total"},ae={class:"total-amount"},se=N({__name:"Shop",setup(oe){const x=O(),I=A(),q=v([{id:"LAPTOP-001",name:"笔记本电脑",desc:"高性能轻薄本",price:5999,image:"laptop",stock:50},{id:"PHONE-001",name:"智能手机",desc:"旗舰5G手机",price:3999,image:"smartphone",stock:100},{id:"TABLET-001",name:"平板电脑",desc:"10寸高清屏",price:2499,image:"tablet",stock:30},{id:"WATCH-001",name:"智能手表",desc:"健康监测",price:1299,image:"watch",stock:80},{id:"EARPHONE-001",name:"无线耳机",desc:"主动降噪",price:899,image:"headphones",stock:200},{id:"KEYBOARD-001",name:"机械键盘",desc:"青轴RGB",price:399,image:"keyboard",stock:150}]),n=v([]),b=g(()=>n.value.reduce((s,e)=>s+e.price*e.quantity,0)),z=g(()=>n.value.reduce((s,e)=>s+e.quantity,0)),B=s=>{const e=n.value.find(c=>c.productId===s.id);e?e.quantity++:n.value.push({productId:s.id,name:s.name,price:s.price,quantity:1})},E=s=>{const e=n.value.findIndex(c=>c.productId===s);e>-1&&n.value.splice(e,1)},k=(s,e)=>{const c=n.value.find(d=>d.productId===s);c&&(c.quantity=Math.max(1,c.quantity+e))},f=v(!1),m=v(!1),F=async()=>{if(n.value.length!==0){f.value=!0;try{const s=await I.createOrder({customerId:"USER-"+Date.now().toString(36),items:n.value.map(e=>({productId:e.productId,productName:e.name,quantity:e.quantity,unitPrice:e.price}))});n.value=[],m.value=!1,x.push(`/my-orders/${s.orderId}`)}catch(s){console.error("Checkout failed:",s)}finally{f.value=!1}}};return(s,e)=>{const c=p("va-icon"),d=p("va-button"),S=p("va-card-content"),T=p("va-card"),$=p("va-divider"),w=p("va-modal");return l(),u("div",R,[a("div",D,[e[3]||(e[3]=a("h1",null,"商品列表",-1)),o(d,{onClick:e[0]||(e[0]=t=>m.value=!0),color:"primary"},{default:r(()=>[o(c,{name:"shopping_cart",class:"mr-2"}),_(" 购物车 ("+i(z.value)+") ",1)]),_:1})]),a("div",L,[(l(!0),u(h,null,C(q.value,t=>(l(),V(T,{key:t.id,class:"product-card"},{default:r(()=>[a("div",H,[o(c,{name:t.image,size:"4rem",color:"primary"},null,8,["name"])]),o(S,null,{default:r(()=>[a("h3",G,i(t.name),1),a("p",U,i(t.desc),1),a("div",K,[a("span",M,"¥"+i(t.price.toFixed(2)),1),o(d,{size:"small",onClick:y=>B(t)},{default:r(()=>[o(c,{name:"add_shopping_cart"})]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),o(w,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),title:"购物车",size:"large"},{footer:r(()=>[o(d,{preset:"secondary",onClick:e[1]||(e[1]=t=>m.value=!1)},{default:r(()=>[...e[8]||(e[8]=[_("继续购物",-1)])]),_:1}),o(d,{color:"primary",disabled:n.value.length===0,loading:f.value,onClick:F},{default:r(()=>[...e[9]||(e[9]=[_(" 立即结算 ",-1)])]),_:1},8,["disabled","loading"])]),default:r(()=>[n.value.length===0?(l(),u("div",Q,[o(c,{name:"remove_shopping_cart",size:"3rem",color:"secondary"}),e[4]||(e[4]=a("p",null,"购物车是空的",-1))])):(l(),u("div",W,[(l(!0),u(h,null,C(n.value,t=>(l(),u("div",{key:t.productId,class:"cart-item"},[a("div",Y,[a("span",j,i(t.name),1),a("span",J,"¥"+i(t.price.toFixed(2)),1)]),a("div",X,[o(d,{size:"small",preset:"secondary",onClick:y=>k(t.productId,-1)},{default:r(()=>[...e[5]||(e[5]=[_("-",-1)])]),_:1},8,["onClick"]),a("span",Z,i(t.quantity),1),o(d,{size:"small",preset:"secondary",onClick:y=>k(t.productId,1)},{default:r(()=>[...e[6]||(e[6]=[_("+",-1)])]),_:1},8,["onClick"]),o(d,{size:"small",color:"danger",preset:"secondary",onClick:y=>E(t.productId)},{default:r(()=>[o(c,{name:"delete"})]),_:1},8,["onClick"])]),a("div",ee," ¥"+i((t.price*t.quantity).toFixed(2)),1)]))),128)),o($),a("div",te,[e[7]||(e[7]=a("span",null,"合计:",-1)),a("span",ae,"¥"+i(b.value.toFixed(2)),1)])]))]),_:1},8,["modelValue"])])}}}),de=P(se,[["__scopeId","data-v-45562fad"]]);export{de as default};
